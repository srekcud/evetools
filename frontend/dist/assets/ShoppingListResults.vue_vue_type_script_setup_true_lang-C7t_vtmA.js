import{u as _}from"./useFormatters-SlNtu6dn.js";import{u as V}from"./useEveImages-B3tDia7r.js";import{d as E,h as r,c as a,b as t,t as s,e as u,l as v,k as i,P as z,F as H,m as J,n as f,r as S,p}from"./index-BmJN7W-L.js";const A={class:"space-y-4"},q={key:0,class:"bg-yellow-900/30 border border-yellow-500/30 rounded-xl p-4"},P={class:"text-yellow-400 font-medium mb-2"},W={class:"text-yellow-300/70 text-sm"},D={key:1,class:"bg-yellow-900/30 border border-yellow-500/30 rounded-xl p-4 text-yellow-400"},R={key:2,class:"bg-amber-900/30 border border-amber-500/50 rounded-lg p-3"},Q={class:"flex items-center justify-between gap-3"},U={class:"flex items-center gap-3"},G={class:"text-sm"},K={class:"text-amber-400/70 text-xs mt-0.5"},O=["disabled"],X={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},Y={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Z={key:3,class:"text-xs text-slate-500 flex items-center gap-2"},tt={class:"bg-slate-800/50 rounded-lg p-4 border border-slate-700"},et={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"},st={class:"text-lg font-mono text-slate-200"},ot={class:"text-lg font-mono text-cyan-400"},nt={class:"text-xs text-slate-500 uppercase tracking-wider mb-1"},lt={class:"text-lg font-mono text-purple-400"},rt={class:"text-lg font-mono text-green-400 font-bold"},at={class:"flex flex-wrap gap-3"},it={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ut={key:1,class:"w-4 h-4 text-green-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},dt={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ct={key:1,class:"w-4 h-4 text-green-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},pt={class:"bg-slate-900/50 backdrop-blur border border-slate-700 rounded-xl overflow-hidden"},xt={class:"p-4 border-b border-slate-700/50 flex items-center justify-between"},mt={class:"text-lg font-semibold text-slate-200"},yt={class:"flex items-center gap-4 text-sm"},gt={class:"flex items-center gap-2"},ht={class:"text-slate-400"},vt={class:"flex items-center gap-2"},ft={class:"text-slate-400"},bt={class:"overflow-x-auto"},kt={class:"w-full text-sm"},wt={class:"bg-slate-800/50 text-slate-400 text-xs uppercase tracking-wider"},jt={class:"px-4 py-3 text-right"},Ct={class:"divide-y divide-slate-700/30"},Lt={class:"px-4 py-3"},St={class:"flex items-center gap-3"},Bt=["src","alt"],It={class:"text-slate-200"},Mt={class:"px-4 py-3 text-right text-slate-300 font-mono"},Tt={class:"px-4 py-3 text-right text-slate-400 font-mono text-xs"},$t={class:"px-4 py-3 text-center"},Ft={key:1,class:"text-slate-500"},Et=E({__name:"ShoppingListResults",props:{items:{},totals:{},structureName:{},notFound:{},priceError:{},structureAccessible:{type:Boolean},structureFromCache:{type:Boolean},structureLastSync:{},isSyncing:{type:Boolean},readonly:{type:Boolean}},emits:["syncStructure"],setup(o,{emit:B}){const b=o,I=B,{formatIsk:c,formatNumber:k,formatDateTime:M}=_(),{getTypeIconUrl:T,onImageError:j}=V(),x=S(!1),m=S(!1),y=p(()=>b.items.filter(n=>n.bestLocation==="jita"||n.bestLocation===null)),g=p(()=>b.items.filter(n=>n.bestLocation==="structure")),$=p(()=>y.value.map(n=>`${n.typeName}	${n.quantity}`).join(`
`)),F=p(()=>g.value.map(n=>`${n.typeName}	${n.quantity}`).join(`
`)),d=p(()=>{var n;return((n=b.structureName)==null?void 0:n.split(" - ")[0])||"Structure"});function N(n){if(!n)return"";const e=new Date(n),w=new Date().getTime()-e.getTime(),h=Math.floor(w/6e4),L=Math.floor(h/60);return h<1?"il y a moins d'une minute":h<60?`il y a ${h} min`:L<24?`il y a ${L}h`:M(n)}function C(n,e){n&&(navigator.clipboard.writeText(n),e==="jita"?(x.value=!0,setTimeout(()=>x.value=!1,2e3)):(m.value=!0,setTimeout(()=>m.value=!1,2e3)))}return(n,e)=>(r(),a("div",A,[o.notFound&&o.notFound.length>0?(r(),a("div",q,[t("h3",P,"Items non trouves ("+s(o.notFound.length)+")",1),t("p",W,s(o.notFound.join(", ")),1)])):u("",!0),o.priceError?(r(),a("div",D,s(o.priceError),1)):u("",!0),o.structureAccessible===!1&&!o.priceError?(r(),a("div",R,[t("div",Q,[t("div",U,[e[5]||(e[5]=t("svg",{class:"w-5 h-5 text-amber-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),t("div",G,[e[4]||(e[4]=t("p",{class:"text-amber-300"},"Prix de la structure non disponibles",-1)),t("p",K," Les donnees de marche pour "+s(o.structureName)+" n'ont pas ete synchronisees. ",1)])]),o.readonly?u("",!0):(r(),a("button",{key:0,onClick:e[0]||(e[0]=l=>I("syncStructure")),disabled:o.isSyncing,class:"px-3 py-1.5 bg-cyan-600 hover:bg-cyan-500 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-white text-sm font-medium transition-colors flex items-center gap-2"},[o.isSyncing?(r(),a("svg",X,[...e[6]||(e[6]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(r(),a("svg",Y,[...e[7]||(e[7]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),v(" "+s(o.isSyncing?"Synchronisation...":"Synchroniser"),1)],8,O))])])):u("",!0),o.structureFromCache&&o.structureLastSync?(r(),a("div",Z,[e[8]||(e[8]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),v(" Prix "+s(d.value)+" mis a jour "+s(N(o.structureLastSync)),1)])):u("",!0),t("div",tt,[t("div",et,[t("div",null,[e[9]||(e[9]=t("p",{class:"text-xs text-slate-500 uppercase tracking-wider mb-1"},"Volume total",-1)),t("p",st,s(i(k)(o.totals.volume))+" m³",1)]),t("div",null,[e[10]||(e[10]=t("p",{class:"text-xs text-slate-500 uppercase tracking-wider mb-1"},"Jita + Transport",-1)),t("p",ot,s(i(c)(o.totals.jitaWithImport)),1)]),t("div",null,[t("p",nt,s(d.value),1),t("p",lt,s(i(c)(o.totals.structure)),1)]),t("div",null,[e[11]||(e[11]=t("p",{class:"text-xs text-slate-500 uppercase tracking-wider mb-1"},"Meilleur prix",-1)),t("p",rt,s(i(c)(o.totals.best)),1)])]),t("div",at,[y.value.length>0?(r(),a("button",{key:0,onClick:e[1]||(e[1]=l=>C($.value,"jita")),class:"flex items-center gap-2 px-4 py-2 bg-cyan-700 hover:bg-cyan-600 rounded-lg text-white text-sm font-medium transition-colors"},[x.value?(r(),a("svg",ut,[...e[13]||(e[13]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(r(),a("svg",it,[...e[12]||(e[12]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])])),v(" "+s(x.value?"Copie !":`Copier Jita (${y.value.length})`),1)])):u("",!0),g.value.length>0?(r(),a("button",{key:1,onClick:e[2]||(e[2]=l=>C(F.value,"structure")),class:"flex items-center gap-2 px-4 py-2 bg-purple-700 hover:bg-purple-600 rounded-lg text-white text-sm font-medium transition-colors"},[m.value?(r(),a("svg",ct,[...e[15]||(e[15]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(r(),a("svg",dt,[...e[14]||(e[14]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])])),v(" "+s(m.value?"Copie !":`Copier ${d.value} (${g.value.length})`),1)])):u("",!0)])]),z(n.$slots,"after-summary"),t("div",pt,[t("div",xt,[t("h3",mt," Items ("+s(o.items.length)+") ",1),t("div",yt,[t("span",gt,[e[16]||(e[16]=t("span",{class:"w-3 h-3 rounded-full bg-cyan-500"},null,-1)),t("span",ht,"Jita ("+s(y.value.length)+")",1)]),t("span",vt,[e[17]||(e[17]=t("span",{class:"w-3 h-3 rounded-full bg-purple-500"},null,-1)),t("span",ft,s(d.value)+" ("+s(g.value.length)+")",1)])])]),t("div",bt,[t("table",kt,[t("thead",wt,[t("tr",null,[e[18]||(e[18]=t("th",{class:"px-4 py-3 text-left"},"Item",-1)),e[19]||(e[19]=t("th",{class:"px-4 py-3 text-right"},"Quantite",-1)),e[20]||(e[20]=t("th",{class:"px-4 py-3 text-right"},"Volume",-1)),e[21]||(e[21]=t("th",{class:"px-4 py-3 text-right"},"Jita + Import",-1)),t("th",jt,s(d.value),1),e[22]||(e[22]=t("th",{class:"px-4 py-3 text-center"},"Acheter a",-1))])]),t("tbody",Ct,[(r(!0),a(H,null,J(o.items,l=>(r(),a("tr",{key:l.typeId,class:f(["hover:bg-slate-800/30 transition-colors",{"bg-cyan-900/10":l.bestLocation==="jita","bg-purple-900/10":l.bestLocation==="structure"}])},[t("td",Lt,[t("div",St,[t("img",{src:i(T)(l.typeId),alt:l.typeName,onError:e[3]||(e[3]=(...w)=>i(j)&&i(j)(...w)),class:"w-8 h-8 rounded"},null,40,Bt),t("span",It,s(l.typeName),1)])]),t("td",Mt,s(i(k)(l.quantity)),1),t("td",Tt,s(i(k)(l.totalVolume))+" m³ ",1),t("td",{class:f(["px-4 py-3 text-right font-mono",l.bestLocation==="jita"||l.bestLocation===null?"text-cyan-400 font-medium":"text-slate-400"])},s(l.jitaWithImport!==null?i(c)(l.jitaWithImport):"-"),3),t("td",{class:f(["px-4 py-3 text-right font-mono",l.bestLocation==="structure"?"text-purple-400 font-medium":"text-slate-400"])},s(l.structureTotal!==null?i(c)(l.structureTotal):"-"),3),t("td",$t,[l.bestLocation?(r(),a("span",{key:0,class:f(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",l.bestLocation==="jita"?"bg-cyan-900/50 text-cyan-300":"bg-purple-900/50 text-purple-300"])},s(l.bestLocation==="jita"?"Jita":d.value),3)):(r(),a("span",Ft,"-"))])],2))),128))])])])])]))}});export{Et as _};
