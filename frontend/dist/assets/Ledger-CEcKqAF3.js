import{E as mt,r as u,p as F,G as ve,d as Oe,o as at,z as Se,h as a,c as l,k as i,b as e,F as H,t as r,n as M,e as v,q as Ze,u as xt,l as pe,m as K,i as fe,T as Le,y as Ce,B as xe,C as ht,D as he,j as B,s as $e,H as kt,w as wt,A as Ne}from"./index-BrHa6dug.js";import{u as dt}from"./useFormatters-CV5q413z.js";import{u as ft}from"./useEveImages-B3tDia7r.js";import{_ as _t}from"./MainLayout.vue_vue_type_style_index_0_lang-DJ721N8Q.js";import{C as ct,a as gt,L as yt,P as $t,b as St,p as bt,c as ut,d as pt,i as Ct,e as jt,B as Et,f as It,A as Tt,D as Pt}from"./index-BGj_mOAn.js";const Mt=mt("ledger",()=>{const U=u(null),y=u(null),h=u([]),_=u(null),p=u(null),m=u(null),x=u(null),T=u(!1),N=u(!1),k=u(null),$=u(30),z=F(()=>U.value!==null),se=F(()=>h.value.length>0||_.value!==null);async function V(w){T.value=!0,k.value=null;try{const f=w??$.value;U.value=await ve(`/ledger/dashboard?days=${f}`)}catch(f){k.value=f instanceof Error?f.message:"Failed to fetch dashboard"}finally{T.value=!1}}async function le(w){k.value=null;try{const f=w??$.value;y.value=await ve(`/ledger/stats/daily?days=${f}`)}catch(f){k.value=f instanceof Error?f.message:"Failed to fetch daily stats"}}async function ne(w,f,Q,de,R,G){T.value=!0,k.value=null;try{let ee=`/ledger/mining/entries?days=${w??$.value}`;f&&(ee+=`&typeId=${f}`),Q&&(ee+=`&usage=${Q}`),de&&(ee+=`&structureId=${de}`),R&&(ee+=`&reprocessYield=${R}`),G!==void 0&&(ee+=`&exportTax=${G}`),h.value=await ve(ee)}catch(X){k.value=X instanceof Error?X.message:"Failed to fetch mining entries"}finally{T.value=!1}}async function re(w){k.value=null;try{const f=w??$.value;_.value=await ve(`/ledger/mining/stats?days=${f}`)}catch(f){k.value=f instanceof Error?f.message:"Failed to fetch mining stats"}}async function j(w){k.value=null;try{const f=w??$.value;p.value=await ve(`/ledger/mining/stats/daily?days=${f}`)}catch(f){k.value=f instanceof Error?f.message:"Failed to fetch mining daily stats"}}async function me(w){k.value=null;try{const f=w??$.value;m.value=await ve(`/ledger/mining/stats/by-type?days=${f}`)}catch(f){k.value=f instanceof Error?f.message:"Failed to fetch mining stats by type"}}async function O(){k.value=null;try{x.value=await ve("/ledger/settings")}catch(w){k.value=w instanceof Error?w.message:"Failed to fetch settings"}}async function ge(w){k.value=null;try{x.value=await ve("/ledger/settings",{method:"PATCH",body:JSON.stringify(w)}),await V()}catch(f){throw k.value=f instanceof Error?f.message:"Failed to update settings",f}}async function Y(w,f,Q,de){k.value=null;try{const R={usage:f};Q!==void 0&&(R.linkedProjectId=Q),de!==void 0&&(R.linkedCorpProjectId=de);const G=await ve(`/ledger/mining/entries/${w}`,{method:"PATCH",body:JSON.stringify(R)}),X=h.value.findIndex(ee=>ee.id===w);return X!==-1&&h.value.splice(X,1,G),G}catch(R){throw k.value=R instanceof Error?R.message:"Failed to update entry",R}}async function je(){N.value=!0,k.value=null;try{const w=await ve("/ledger/mining/sync",{method:"POST",body:JSON.stringify({})});return await Promise.all([V(),re(),ne()]),w}catch(w){throw k.value=w instanceof Error?w.message:"Failed to sync mining data",w}finally{N.value=!1}}function ie(w){$.value=w}function ye(){k.value=null}return{dashboard:U,dailyStats:y,miningEntries:h,miningStats:_,miningDailyStats:p,miningStatsByType:m,settings:x,isLoading:T,isSyncing:N,error:k,selectedDays:$,hasData:z,hasMiningData:se,fetchDashboard:V,fetchDailyStats:le,fetchMiningEntries:ne,fetchMiningStats:re,fetchMiningDailyStats:j,fetchMiningStatsByType:me,fetchSettings:O,updateSettings:ge,updateMiningEntryUsage:Y,syncMining:je,setSelectedDays:ie,clearError:ye}}),vt=mt("pve",()=>{const U=u(null),y=u([]),h=u(!1),_=u(null),p=u(30);async function m(k){h.value=!0,_.value=null;try{const $=k??p.value;U.value=await ve(`/pve/stats?days=${$}`)}catch($){_.value=$ instanceof Error?$.message:"Failed to fetch stats"}finally{h.value=!1}}async function x(k){_.value=null;try{const $=k??p.value,z=await ve(`/pve/stats/daily?days=${$}`);y.value=z.daily}catch($){_.value=$ instanceof Error?$.message:"Failed to fetch daily stats"}}function T(k){p.value=k}function N(){_.value=null}return{stats:U,dailyStats:y,isLoading:h,error:_,selectedDays:p,fetchStats:m,fetchDailyStats:x,setSelectedDays:T,clearError:N}}),At={class:"space-y-6"},Bt={key:0,class:"flex items-center justify-center py-12"},Dt={key:0,class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Ft={class:"bg-slate-800 rounded-lg p-4"},Nt={class:"text-2xl font-bold text-emerald-400"},Lt={class:"bg-slate-800 rounded-lg p-4"},zt={class:"text-2xl font-bold text-red-400"},Vt={class:"bg-slate-800 rounded-lg p-4"},Ot={class:"bg-slate-800 rounded-lg p-4"},Rt={class:"text-2xl font-bold text-cyan-400"},Ht={key:1,class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Ut={class:"bg-slate-900 rounded-lg p-3 border border-slate-800"},qt={class:"text-lg font-medium text-emerald-400"},Jt={class:"bg-slate-900 rounded-lg p-3 border border-slate-800"},Kt={class:"text-lg font-medium text-violet-400"},Yt={class:"bg-slate-900 rounded-lg p-3 border border-slate-800"},Qt={class:"text-lg font-medium text-sky-400"},Wt={class:"bg-slate-900 rounded-lg p-3 border border-slate-800"},Zt={class:"text-lg font-medium text-amber-400"},Gt={key:2,class:"text-center py-12 text-slate-500"},Xt=Oe({__name:"PveDashboard",props:{days:{}},setup(U){const y=U,h=vt(),{formatIsk:_}=dt();async function p(){const m=y.days??h.selectedDays;await Promise.all([h.fetchStats(m),h.fetchDailyStats(m)])}return at(()=>{p()}),Se(()=>y.days,()=>{p()}),(m,x)=>(a(),l("div",At,[i(h).isLoading?(a(),l("div",Bt,[...x[0]||(x[0]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-500"},null,-1),e("span",{class:"ml-3 text-slate-400"},"Chargement des statistiques...",-1)])])):(a(),l(H,{key:1},[i(h).stats?(a(),l("div",Dt,[e("div",Ft,[x[1]||(x[1]=e("div",{class:"text-slate-400 text-sm"},"Revenus totaux",-1)),e("div",Nt,r(i(_)(i(h).stats.totals.income)),1)]),e("div",Lt,[x[2]||(x[2]=e("div",{class:"text-slate-400 text-sm"},"Dépenses totales",-1)),e("div",zt,r(i(_)(i(h).stats.totals.expenses)),1)]),e("div",Vt,[x[3]||(x[3]=e("div",{class:"text-slate-400 text-sm"},"Bénéfice net",-1)),e("div",{class:M(["text-2xl font-bold",i(h).stats.totals.profit>=0?"text-emerald-400":"text-red-400"])},r(i(_)(i(h).stats.totals.profit)),3)]),e("div",Ot,[x[4]||(x[4]=e("div",{class:"text-slate-400 text-sm"},"ISK/jour (moy.)",-1)),e("div",Rt,r(i(_)(i(h).stats.iskPerDay)),1)])])):v("",!0),i(h).stats?(a(),l("div",Ht,[e("div",Ut,[x[5]||(x[5]=e("div",{class:"text-slate-500 text-xs"},"Bounties",-1)),e("div",qt,r(i(_)(i(h).stats.totals.bounties)),1)]),e("div",Jt,[x[6]||(x[6]=e("div",{class:"text-slate-500 text-xs"},"ESS Payouts",-1)),e("div",Kt,r(i(_)(i(h).stats.totals.ess)),1)]),e("div",Yt,[x[7]||(x[7]=e("div",{class:"text-slate-500 text-xs"},"Missions",-1)),e("div",Qt,r(i(_)(i(h).stats.totals.missions)),1)]),e("div",Wt,[x[8]||(x[8]=e("div",{class:"text-slate-500 text-xs"},"Ventes de loot",-1)),e("div",Zt,r(i(_)(i(h).stats.totals.lootSales)),1)])])):v("",!0),!i(h).stats&&!i(h).isLoading?(a(),l("div",Gt,[...x[9]||(x[9]=[e("svg",{class:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),e("p",{class:"text-lg"},"Aucune donnée à afficher",-1),e("p",{class:"text-sm mt-1"},"Commencez à suivre vos activités PVE pour voir les statistiques",-1)])])):v("",!0)],64))]))}}),es={class:"bg-gray-800 rounded-lg p-4"},ts={class:"h-64"},ss=Oe({__name:"IncomeChart",props:{data:{}},setup(U){ct.register(gt,yt,$t,St,bt,ut,pt,Ct);const y=U,h=F(()=>({labels:y.data.map(p=>new Date(p.date).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"})),datasets:[{label:"Total Income",data:y.data.map(p=>p.income/1e9),borderColor:"#06b6d4",backgroundColor:"rgba(6, 182, 212, 0.1)",fill:!0,tension:.3},{label:"Bounties",data:y.data.map(p=>p.bounties/1e9),borderColor:"#10b981",backgroundColor:"transparent",tension:.3},{label:"Loot Sales",data:y.data.map(p=>p.lootSales/1e9),borderColor:"#f59e0b",backgroundColor:"transparent",tension:.3}]})),_={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:"#9ca3af"}},tooltip:{callbacks:{label:p=>`${p.dataset.label}: ${p.raw.toFixed(2)}B ISK`}}},scales:{x:{ticks:{color:"#9ca3af"},grid:{color:"rgba(75, 85, 99, 0.3)"}},y:{ticks:{color:"#9ca3af",callback:p=>`${p}B`},grid:{color:"rgba(75, 85, 99, 0.3)"}}}};return(p,m)=>(a(),l("div",es,[m[0]||(m[0]=e("h3",{class:"text-lg font-medium text-white mb-4"},"Income Over Time",-1)),e("div",ts,[Ze(i(jt),{data:h.value,options:_},null,8,["data"])])]))}}),os={class:"bg-gray-800 rounded-lg p-4"},as={class:"h-64"},ls=Oe({__name:"ProfitTrendChart",props:{data:{}},setup(U){ct.register(gt,yt,Et,bt,ut,pt);const y=U,h=F(()=>({labels:y.data.map(p=>new Date(p.date).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"})),datasets:[{label:"Profit",data:y.data.map(p=>p.profit/1e9),backgroundColor:y.data.map(p=>p.profit>=0?"rgba(16, 185, 129, 0.7)":"rgba(239, 68, 68, 0.7)"),borderColor:y.data.map(p=>p.profit>=0?"#10b981":"#ef4444"),borderWidth:1}]})),_={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:p=>{const m=p.raw;return`Profit: ${m>=0?"+":""}${m.toFixed(2)}B ISK`}}}},scales:{x:{ticks:{color:"#9ca3af"},grid:{display:!1}},y:{ticks:{color:"#9ca3af",callback:p=>`${p}B`},grid:{color:"rgba(75, 85, 99, 0.3)"}}}};return(p,m)=>(a(),l("div",os,[m[0]||(m[0]=e("h3",{class:"text-lg font-medium text-white mb-4"},"Daily Profit",-1)),e("div",as,[Ze(i(It),{data:h.value,options:_},null,8,["data"])])]))}}),ns={class:"bg-gray-800 rounded-lg p-4"},rs={key:0,class:"h-64"},is={key:1,class:"h-64 flex items-center justify-center text-gray-500"},ds=Oe({__name:"ExpenseBreakdownChart",props:{data:{}},setup(U){ct.register(Tt,ut,pt);const y=U,h={fuel:"Fuel",ammo:"Consommables",crab_beacon:"CRAB Beacons",other:"Other"},_={fuel:"#ef4444",ammo:"#f59e0b",crab_beacon:"#8b5cf6",other:"#6b7280"},p=F(()=>{const T=[],N=[],k=[];return Object.entries(y.data).forEach(([$,z])=>{z>0&&(T.push(h[$]||$),N.push(z/1e9),k.push(_[$]||"#6b7280"))}),{labels:T,datasets:[{data:N,backgroundColor:k,borderColor:"#1f2937",borderWidth:2}]}}),m={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#9ca3af",padding:15}},tooltip:{callbacks:{label:T=>{const N=T.dataset.data.reduce(($,z)=>$+z,0),k=(T.raw/N*100).toFixed(1);return`${T.label}: ${T.raw.toFixed(2)}B ISK (${k}%)`}}}}},x=F(()=>Object.values(y.data).some(T=>T>0));return(T,N)=>(a(),l("div",ns,[N[0]||(N[0]=e("h3",{class:"text-lg font-medium text-white mb-4"},"Expense Breakdown",-1)),x.value?(a(),l("div",rs,[Ze(i(Pt),{data:p.value,options:m},null,8,["data"])])):(a(),l("div",is," No expenses recorded "))]))}}),cs={class:"space-y-6"},us={class:"flex items-center justify-between"},ps={key:0,class:"text-xs text-slate-500 mt-1"},vs={key:1,class:"text-xs text-amber-500 mt-1"},ms={class:"flex items-center gap-3"},xs=["disabled"],fs=["disabled"],gs={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ys={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},bs={key:0,class:"p-4 bg-red-500/20 border border-red-500/50 rounded-lg text-red-400 flex items-center justify-between"},hs={key:1,class:"flex flex-col items-center justify-center py-20"},ks={class:"mb-8"},ws={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},_s={class:"bg-slate-900 rounded-xl border border-slate-800 overflow-hidden"},$s={class:"px-5 py-4 border-b border-slate-800"},Ss={class:"text-sm text-slate-500"},Cs={key:0,class:"divide-y divide-slate-800 max-h-96 overflow-y-auto"},js={class:"flex items-center gap-2"},Es={class:"text-sm text-slate-200"},Is={class:"text-xs text-slate-500"},Ts={class:"text-emerald-400 font-mono text-sm"},Ps={key:1,class:"px-5 py-8 text-center text-slate-500"},Ms={class:"bg-slate-900 rounded-xl border border-slate-800 overflow-hidden"},As={class:"px-5 py-4 border-b border-slate-800 flex items-center justify-between"},Bs={class:"flex gap-2"},Ds=["disabled"],Fs={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ns={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ls=["title"],zs={key:0,class:"divide-y divide-slate-800 max-h-96 overflow-y-auto"},Vs={class:"flex items-center gap-3"},Os={class:"text-sm text-slate-200"},Rs={class:"text-xs text-slate-500"},Hs={class:"flex items-center gap-3"},Us={class:"text-amber-400 font-mono text-sm"},qs=["onClick"],Js={key:1,class:"px-5 py-8 text-center text-slate-500"},Ks={class:"bg-slate-900 rounded-xl border border-slate-800 overflow-hidden"},Ys={key:0,class:"divide-y divide-slate-800 max-h-96 overflow-y-auto"},Qs={class:"flex items-center gap-3"},Ws={class:"text-sm text-slate-200"},Zs={class:"text-xs text-slate-500"},Gs={class:"flex items-center gap-3"},Xs={class:"text-red-400 font-mono text-sm"},eo=["onClick"],to={key:1,class:"px-5 py-8 text-center text-slate-500"},so={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6"},oo={class:"bg-slate-900 rounded-xl border border-slate-700 max-w-md w-full p-6"},ao={class:"space-y-4"},lo=["value"],no={key:0,class:"text-red-400 text-xs mt-1"},ro={key:0,class:"text-red-400 text-xs mt-1"},io={class:"flex gap-3 mt-6"},co=["disabled"],uo=["disabled"],po={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},vo={class:"bg-slate-900 rounded-xl border border-slate-700 max-w-lg w-full p-6"},mo={class:"flex items-center justify-between mb-4"},xo={class:"relative mb-4"},fo={key:0,class:"absolute right-3 top-2.5"},go={key:0,class:"mb-4 bg-slate-800 rounded-lg border border-slate-700 max-h-48 overflow-y-auto"},yo=["onClick","disabled"],bo={key:1,class:"space-y-2 max-h-48 overflow-y-auto"},ho={class:"flex items-center gap-3"},ko=["src","alt"],wo={class:"text-sm"},_o=["onClick"],$o={key:2,class:"text-center py-6 text-slate-500"},So={class:"mt-6 pt-4 border-t border-slate-800"},Co={class:"bg-slate-900 rounded-xl border border-slate-700 max-w-lg w-full p-6"},jo={class:"flex items-center justify-between mb-4"},Eo={class:"relative mb-4"},Io={key:0,class:"absolute right-3 top-2.5"},To={key:0,class:"mb-4 bg-slate-800 rounded-lg border border-slate-700 max-h-48 overflow-y-auto"},Po=["onClick","disabled"],Mo={key:1,class:"space-y-2 max-h-48 overflow-y-auto"},Ao={class:"flex items-center gap-3"},Bo=["src","alt"],Do={class:"text-sm"},Fo=["onClick"],No={key:2,class:"text-center py-6 text-slate-500"},Lo={class:"mt-6 pt-4 border-t border-slate-800"},zo={class:"bg-slate-900 rounded-xl border border-slate-700 max-w-2xl w-full max-h-[80vh] flex flex-col"},Vo={class:"p-6 border-b border-slate-800"},Oo={class:"flex items-center justify-between"},Ro={class:"text-sm text-slate-400 mt-1"},Ho={key:0,class:"flex-1 overflow-y-auto p-6"},Uo={class:"space-y-3"},qo=["onClick"],Jo={class:"flex items-start gap-4"},Ko={class:"flex-shrink-0 pt-1"},Yo={key:0,class:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Qo=["src","alt"],Wo={class:"flex-1 min-w-0"},Zo={class:"flex items-center gap-2 mb-1"},Go={key:0,class:"text-xs text-slate-500"},Xo={key:1,class:"text-xs text-blue-400"},ea={class:"text-sm text-slate-300"},ta={class:"text-right"},sa={class:"text-red-400 font-mono"},oa={class:"text-xs text-slate-500"},aa={key:1,class:"flex-1 flex items-center justify-center p-6"},la={key:2,class:"p-6 border-t border-slate-800"},na={class:"flex items-center justify-between mb-4"},ra={class:"text-sm text-slate-400"},ia={class:"text-red-400 font-mono"},da={class:"flex gap-3"},ca=["disabled"],ua={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},pa={class:"bg-slate-900 rounded-xl border border-slate-700 max-w-md w-full p-6"},va={class:"space-y-4"},ma={key:0,class:"text-red-400 text-xs mt-1"},xa={key:0,class:"text-red-400 text-xs mt-1"},fa={class:"flex gap-3 mt-6"},ga=["disabled"],ya=["disabled"],ba={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ha={class:"bg-slate-900 rounded-xl border border-slate-700 max-w-2xl w-full max-h-[80vh] flex flex-col"},ka={class:"p-6 border-b border-slate-800"},wa={class:"flex items-center justify-between"},_a={class:"text-sm text-slate-400 mt-1"},$a={key:0,class:"flex-1 overflow-y-auto p-6"},Sa={class:"space-y-3"},Ca={class:"flex items-start gap-4"},ja=["src","alt"],Ea={class:"flex-1 min-w-0"},Ia={class:"flex items-center gap-2 mb-1"},Ta={key:0,class:"text-xs px-2 py-0.5 rounded bg-amber-500/20 text-amber-400"},Pa={key:1,class:"text-xs px-2 py-0.5 rounded bg-violet-500/20 text-violet-400"},Ma={key:2,class:"text-xs px-2 py-0.5 rounded bg-blue-500/20 text-blue-400"},Aa={class:"text-xs text-slate-500"},Ba={class:"text-sm text-slate-300"},Da={class:"text-xs text-slate-500"},Fa={class:"flex flex-col items-end gap-2"},Na={key:0,class:"flex items-center gap-1"},La=["onUpdate:modelValue","placeholder"],za={key:1,class:"text-amber-400 font-mono text-sm"},Va={class:"flex gap-2"},Oa=["onClick","disabled"],Ra=["onClick","disabled"],Ha={key:1,class:"flex-1 flex items-center justify-center p-6"},Ua={key:2,class:"p-4 border-t border-slate-800"},qa={class:"flex items-center justify-between"},Ja={class:"text-sm text-slate-400"},Ka=Oe({__name:"PveTab",props:{selectedDays:{}},emits:["sync"],setup(U,{expose:y,emit:h}){const _=U,p=h,m=xt(),x=vt(),{formatIskFull:T,formatDate:N,formatDateTime:k}=dt(),{getTypeIconUrl:$,onImageError:z}=ft(),se=u(null),V=u([]),le=u(!1),ne=u(!1),re=u(!1),j=u(""),me=u(!1),O=u({type:"fuel",description:"",amount:"",date:new Date().toISOString().split("T")[0]}),ge=u(!1),Y=u({}),je=u([]),ie=u(!1),ye=u(""),w=u([]),f=u(!1),Q=u(!1),de=u([]),R=u(!1),G=u(""),X=u([]),ee=u(!1),Re=u(!1),Ee=u(!1),S=u(null),te=u(!1),ke=u(!1),L=u(!1),q=u({description:"",amount:"",date:new Date().toISOString().split("T")[0]}),E=u({}),W=u(!1),ce=u(!1),A=u(null),Ae=u(!1),Be=u(!1),be=u(new Set),De=u(new Set),Ie=u(0),Te=u(0),He=[{value:"fuel",label:"Fuel"},{value:"ammo",label:"Consommables"},{value:"crab_beacon",label:"Crab Beacon"},{value:"other",label:"Autre"}];async function ue(){le.value=!0,j.value="";try{const n=await B(`/api/pve/income?days=${_.selectedDays}`,{headers:{Authorization:`Bearer ${m.token}`}});if(!n.ok)throw new Error("Failed to fetch PVE data");se.value=await $e(n)}catch(n){j.value="Erreur lors du chargement des donnees PVE",console.error(n)}finally{le.value=!1}}async function we(){ne.value=!0;try{const n=await B(`/api/pve/expenses?days=${_.selectedDays}`,{headers:{Authorization:`Bearer ${m.token}`}});n.ok&&(V.value=await $e(n))}catch(n){console.error("Failed to fetch expenses:",n)}finally{ne.value=!1}}async function Ge(){re.value=!0,j.value="";try{const n=await B("/api/pve/sync",{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({})});if(!n.ok){const t=await $e(n);throw new Error(t.error||"Failed to sync")}await Promise.all([ue(),we()]),p("sync")}catch(n){j.value=n instanceof Error?n.message:"Erreur lors de la synchronisation",console.error(n)}finally{re.value=!1}}async function J(){if(Y.value={},O.value.description.trim()||(Y.value.description="Description requise"),(!O.value.amount||parseFloat(O.value.amount)<=0)&&(Y.value.amount="Montant requis"),!(Object.keys(Y.value).length>0)){ge.value=!0;try{if(!(await B("/api/pve/expenses",{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({type:O.value.type,description:O.value.description,amount:parseFloat(O.value.amount),date:O.value.date})})).ok)throw new Error("Failed to add expense");O.value={type:"fuel",description:"",amount:"",date:new Date().toISOString().split("T")[0]},me.value=!1,await Promise.all([ue(),we()])}catch(n){j.value="Erreur lors de l'ajout de la depense",console.error(n)}finally{ge.value=!1}}}async function lt(n){try{if(!(await B(`/api/pve/expenses/${n}`,{method:"DELETE",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({})})).ok)throw new Error("Failed to delete expense");await Promise.all([ue(),we()])}catch(t){j.value="Erreur lors de la suppression",console.error(t)}}function Ue(n){var t;return((t=He.find(g=>g.value===n))==null?void 0:t.label)||n}function Xe(n){switch(n){case"fuel":return"bg-orange-500/20 text-orange-400";case"ammo":return"bg-red-500/20 text-red-400";case"crab_beacon":return"bg-purple-500/20 text-purple-400";default:return"bg-slate-500/20 text-slate-400"}}async function _e(){try{const n=await B("/api/pve/settings",{headers:{Authorization:`Bearer ${m.token}`}});if(n.ok){const t=await $e(n);je.value=t.ammoTypes,de.value=t.lootTypes||[],Ie.value=t.declinedContractsCount||0,Te.value=t.declinedTransactionsCount||0}}catch(n){console.error("Failed to fetch ammo settings:",n)}}let C=null;function ze(){if(C&&clearTimeout(C),ye.value.length<2){w.value=[];return}C=setTimeout(()=>oe(),300)}async function oe(){if(!(ye.value.length<2)){f.value=!0;try{const n=await B(`/api/pve/search-types?query=${encodeURIComponent(ye.value)}`,{headers:{Authorization:`Bearer ${m.token}`}});if(n.ok){const t=await $e(n),g=je.value.map(P=>P.typeId);w.value=t.filter(P=>!g.includes(P.typeId))}}catch(n){console.error("Failed to search ammo types:",n)}finally{f.value=!1}}}async function nt(n){Q.value=!0;try{(await B("/api/pve/settings/ammo",{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({typeId:n})})).ok&&(await _e(),ye.value="",w.value=[])}catch(t){console.error("Failed to add ammo type:",t)}finally{Q.value=!1}}async function I(n){try{(await B(`/api/pve/settings/ammo/${n}`,{method:"DELETE",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({})})).ok&&await _e()}catch(t){console.error("Failed to remove ammo type:",t)}}let qe=null;function Je(){if(qe&&clearTimeout(qe),G.value.length<2){X.value=[];return}qe=setTimeout(()=>rt(),300)}async function rt(){if(!(G.value.length<2)){ee.value=!0;try{const n=await B(`/api/pve/search-types?query=${encodeURIComponent(G.value)}`,{headers:{Authorization:`Bearer ${m.token}`}});if(n.ok){const t=await $e(n),g=de.value.map(P=>P.typeId);X.value=t.filter(P=>!g.includes(P.typeId))}}catch(n){console.error("Failed to search loot types:",n)}finally{ee.value=!1}}}async function et(n){Re.value=!0;try{(await B("/api/pve/settings/loot",{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({typeId:n})})).ok&&(await _e(),G.value="",X.value=[])}catch(t){console.error("Failed to add loot type:",t)}finally{Re.value=!1}}async function Pe(n){try{(await B(`/api/pve/settings/loot/${n}`,{method:"DELETE",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({})})).ok&&await _e()}catch(t){console.error("Failed to remove loot type:",t)}}async function Ke(){te.value=!0,j.value="";try{const n=await B(`/api/pve/scan-contracts?days=${_.selectedDays}`,{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({})});if(!n.ok){const g=await $e(n);throw new Error(g.error||"Failed to scan contracts")}const t=await $e(n);t.detectedExpenses=t.detectedExpenses.map(g=>({...g,selected:!0})),S.value=t,Ee.value=!0}catch(n){j.value=n instanceof Error?n.message:"Erreur lors du scan des contrats",console.error(n)}finally{te.value=!1}}function Me(n){n.selected=!n.selected}function it(){S.value&&S.value.detectedExpenses.forEach(n=>n.selected=!0)}function tt(){S.value&&S.value.detectedExpenses.forEach(n=>n.selected=!1)}async function Ye(){if(!S.value)return;const n=S.value.detectedExpenses.filter(g=>g.selected),t=S.value.detectedExpenses.filter(g=>!g.selected);ke.value=!0,j.value="";try{if(!(await B("/api/pve/import-expenses",{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({expenses:n.map(P=>({type:P.type,typeId:P.typeId,typeName:P.typeName,quantity:P.quantity,price:P.price,dateIssued:P.dateIssued,contractId:P.contractId,transactionId:P.transactionId})),declined:t.map(P=>({contractId:P.contractId,transactionId:P.transactionId}))})})).ok)throw new Error("Failed to import expenses");Ee.value=!1,S.value=null,await Promise.all([ue(),we()])}catch(g){j.value="Erreur lors de l'import des depenses",console.error(g)}finally{ke.value=!1}}function Qe(){E.value={},L.value=!0}async function st(){if(E.value={},q.value.description.trim()||(E.value.description="Description requise"),(!q.value.amount||parseFloat(q.value.amount)<=0)&&(E.value.amount="Montant requis"),!(Object.keys(E.value).length>0)){W.value=!0;try{if(!(await B("/api/pve/loot-sales",{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({description:q.value.description,amount:parseFloat(q.value.amount),date:q.value.date})})).ok)throw new Error("Failed to add loot sale");q.value={description:"",amount:"",date:new Date().toISOString().split("T")[0]},L.value=!1,await ue()}catch(n){j.value="Erreur lors de l'ajout de la vente",console.error(n)}finally{W.value=!1}}}async function Ve(n){try{if(!(await B(`/api/pve/loot-sales/${n}`,{method:"DELETE",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({})})).ok)throw new Error("Failed to delete loot sale");await ue()}catch(t){j.value="Erreur lors de la suppression",console.error(t)}}async function ot(){Ae.value=!0,j.value="";try{const[n,t]=await Promise.all([B(`/api/pve/scan-loot-sales?days=${_.selectedDays}`,{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({})}),B(`/api/pve/scan-loot-contracts?days=${_.selectedDays}`,{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({})})]),g=n.ok?await n.json():{detectedSales:[]},P=t.ok?await t.json():{detectedContracts:[]},Fe=(g.detectedSales||[]).filter(o=>o.source!=="contract").filter(o=>!De.value.has(o.transactionId)).map(o=>({...o,selected:!0,needsPriceInput:o.source==="corp_project"&&o.price===0})),c=(P.detectedContracts||[]).filter(o=>!be.value.has(o.contractId)).map(o=>{var D;return{transactionId:0,contractId:o.contractId,type:"loot_contract",typeId:((D=o.items[0])==null?void 0:D.typeId)||0,typeName:o.description,quantity:o.totalQuantity,price:o.contractPrice,dateIssued:o.date,characterName:o.characterName,source:"contract",selected:!0,needsPriceInput:o.contractPrice===0}}),Z=[...Fe,...c];if(Z.length===0&&g.noLootTypesConfigured){R.value=!0;return}A.value={scannedTransactions:g.scannedTransactions||0,scannedContracts:(g.scannedContracts||0)+(P.scannedContracts||0),scannedProjects:g.scannedProjects||0,detectedSales:Z},ce.value=!0}catch(n){j.value=n instanceof Error?n.message:"Erreur lors du scan des ventes",console.error(n)}finally{Ae.value=!1}}async function d(n){if(A.value){Be.value=!0,j.value="";try{if(n.source==="contract"){const t=await B("/api/pve/import-loot-contracts",{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({contracts:[{contractId:n.contractId,price:n.price,description:n.typeName,date:n.dateIssued}],declined:[]})});if(!t.ok)throw new Error("Failed to import contract");const g=await $e(t);if(g.rejectedZeroPrice&&g.rejectedZeroPrice>0){j.value="Contrat rejete : le prix doit etre superieur a 0 ISK";return}n.contractId&&be.value.add(n.contractId)}else if(n.source==="corp_project"){if(!(await B("/api/pve/import-loot-sales",{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({sales:[{type:"corp_project",typeId:n.typeId,typeName:`${n.projectName||"Projet corp"}: ${n.typeName}`,quantity:n.quantity,price:n.price,dateIssued:n.dateIssued,transactionId:n.transactionId}],declined:[]})})).ok)throw new Error("Failed to import contribution");n.transactionId&&De.value.add(n.transactionId)}else{if(!(await B("/api/pve/import-loot-sales",{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({sales:[{type:n.type,typeId:n.typeId,typeName:n.typeName,quantity:n.quantity,price:n.price,dateIssued:n.dateIssued,transactionId:n.transactionId}],declined:[]})})).ok)throw new Error("Failed to import sale");n.transactionId&&De.value.add(n.transactionId)}A.value.detectedSales=A.value.detectedSales.filter(t=>t!==n),await ue()}catch(t){j.value="Erreur lors de l'import",console.error(t)}finally{Be.value=!1}}}async function s(n){if(A.value)try{n.source==="contract"?(await B("/api/pve/import-loot-contracts",{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({contracts:[],declined:[{contractId:n.contractId}]})}),n.contractId&&be.value.add(n.contractId)):(await B("/api/pve/import-loot-sales",{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({sales:[],declined:[{transactionId:n.transactionId}]})}),n.transactionId&&De.value.add(n.transactionId)),A.value.detectedSales=A.value.detectedSales.filter(t=>t!==n)}catch(t){j.value="Erreur lors de l'ignorement",console.error(t)}}async function b(){const n=[],t=[];if(A.value)for(const g of A.value.detectedSales)g.source==="contract"&&g.contractId?n.push(g.contractId):g.transactionId&&t.push(g.transactionId);try{await B("/api/pve/settings/reset-declined",{method:"POST",headers:{Authorization:`Bearer ${m.token}`,"Content-Type":"application/json"},body:JSON.stringify({keepContractIds:n,keepTransactionIds:t})}),Ie.value=n.length,Te.value=t.length}catch(g){console.error("Failed to reset declined:",g)}be.value.clear(),De.value.clear()}function ae(){Y.value={},me.value=!0}return Se(()=>_.selectedDays,()=>{ue(),we()}),at(()=>{ue(),we(),_e()}),y({refresh:()=>Promise.all([ue(),we()])}),(n,t)=>{var g,P,Fe,c,Z;return a(),l("div",cs,[e("div",us,[e("div",null,[t[32]||(t[32]=e("p",{class:"text-slate-400"},"Suivi des revenus et depenses PVE",-1)),(g=se.value)!=null&&g.lastSyncAt?(a(),l("p",ps," Derniere sync : "+r(i(k)(se.value.lastSyncAt)),1)):(a(),l("p",vs," Aucune synchronisation effectuee "))]),e("div",ms,[e("button",{onClick:t[0]||(t[0]=o=>ie.value=!0),class:"px-4 py-2 bg-slate-800 hover:bg-slate-700 border border-slate-700 rounded-lg text-slate-300 text-sm font-medium flex items-center gap-2",title:"Configurer les consommables"},[...t[33]||(t[33]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1),pe(" Consommables ",-1)])]),e("button",{onClick:Ge,disabled:re.value,class:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500 rounded-lg text-white text-sm font-medium flex items-center gap-2 disabled:opacity-50",title:"Synchroniser les donnees depuis EVE"},[(a(),l("svg",{class:M(["w-4 h-4",re.value?"animate-spin":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[34]||(t[34]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2)),pe(" "+r(re.value?"Sync...":"Rafraichir"),1)],8,xs),e("button",{onClick:Ke,disabled:te.value,class:"px-4 py-2 bg-purple-600 hover:bg-purple-500 rounded-lg text-white text-sm font-medium flex items-center gap-2 disabled:opacity-50"},[te.value?(a(),l("svg",gs,[...t[35]||(t[35]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):(a(),l("svg",ys,[...t[36]||(t[36]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"},null,-1)])])),pe(" "+r(te.value?"Scan en cours...":"Scanner achats"),1)],8,fs),e("button",{type:"button",onClick:ae,class:"px-4 py-2 bg-cyan-600 hover:bg-cyan-500 rounded-lg text-white text-sm font-medium flex items-center gap-2"},[...t[37]||(t[37]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),pe(" Ajouter depense ",-1)])])])]),j.value?(a(),l("div",bs,[e("span",null,r(j.value),1),e("button",{onClick:t[1]||(t[1]=o=>j.value=""),class:"text-red-400 hover:text-red-300"},[...t[38]||(t[38]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])):v("",!0),le.value?(a(),l("div",hs,[...t[39]||(t[39]=[e("svg",{class:"w-10 h-10 animate-spin text-cyan-500 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),e("p",{class:"text-slate-400"},"Chargement des donnees...",-1)])])):se.value?(a(),l(H,{key:2},[e("div",ks,[Ze(Xt,{days:U.selectedDays},null,8,["days"])]),e("div",ws,[e("div",_s,[e("div",$s,[t[40]||(t[40]=e("h3",{class:"font-semibold"},"Bounties recentes",-1)),e("p",Ss,"Revenus NPC des "+r(se.value.period.days)+" derniers jours",1)]),se.value.bounties.entries.length>0?(a(),l("div",Cs,[(a(!0),l(H,null,K(se.value.bounties.entries,o=>(a(),l("div",{key:o.id,class:"px-5 py-3 flex items-center justify-between"},[e("div",js,[e("span",{class:M(["text-xs px-2 py-0.5 rounded",o.refType==="ess"?"bg-violet-500/20 text-violet-400":o.refType==="mission"?"bg-sky-500/20 text-sky-400":"bg-emerald-500/20 text-emerald-400"])},r(o.refTypeLabel),3),e("div",null,[e("p",Es,r(o.characterName),1),e("p",Is,r(i(k)(o.date)),1)])]),e("span",Ts,"+"+r(i(T)(o.amount)),1)]))),128))])):(a(),l("div",Ps," Aucune bounty sur cette periode "))]),e("div",Ms,[e("div",As,[t[46]||(t[46]=e("div",null,[e("h3",{class:"font-semibold"},"Ventes de loot")],-1)),e("div",Bs,[e("button",{onClick:t[2]||(t[2]=o=>R.value=!0),class:"p-1.5 bg-slate-700 hover:bg-slate-600 rounded text-white",title:"Configurer les types de loot"},[...t[41]||(t[41]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])]),e("button",{onClick:ot,disabled:Ae.value,class:"p-1.5 bg-amber-600 hover:bg-amber-500 rounded text-white disabled:opacity-50",title:"Scanner les ventes"},[Ae.value?(a(),l("svg",Fs,[...t[42]||(t[42]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):(a(),l("svg",Ns,[...t[43]||(t[43]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"},null,-1)])]))],8,Ds),Ie.value>0||Te.value>0?(a(),l("button",{key:0,onClick:b,class:"p-1.5 bg-slate-700 hover:bg-red-600 rounded text-slate-400 hover:text-white",title:`Reinitialiser le filtre (${Ie.value+Te.value} elements masques)`},[...t[44]||(t[44]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])],8,Ls)):v("",!0),e("button",{type:"button",onClick:Qe,class:"p-1.5 bg-slate-700 hover:bg-slate-600 rounded text-white",title:"Ajouter manuellement"},[...t[45]||(t[45]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])])])]),se.value.lootSales.entries.length>0?(a(),l("div",zs,[(a(!0),l(H,null,K(se.value.lootSales.entries,o=>(a(),l("div",{key:o.id,class:"px-5 py-3 flex items-center justify-between group"},[e("div",Vs,[e("span",{class:M(["text-xs px-2 py-1 rounded",o.type==="corp_project"?"bg-cyan-500/20 text-cyan-400":"bg-amber-500/20 text-amber-400"])},r(o.type==="corp_project"?"Projet":"Loot"),3),e("div",null,[e("p",Os,r(o.description),1),e("p",Rs,r(i(N)(o.date)),1)])]),e("div",Hs,[e("span",Us,"+"+r(i(T)(o.amount)),1),e("button",{onClick:D=>Ve(o.id),class:"opacity-0 group-hover:opacity-100 p-1 hover:bg-red-500/20 rounded text-slate-400 hover:text-red-400 transition-all",title:"Supprimer"},[...t[47]||(t[47]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,qs)])]))),128))])):(a(),l("div",Js," Aucune vente enregistree "))]),e("div",Ks,[t[49]||(t[49]=e("div",{class:"px-5 py-4 border-b border-slate-800"},[e("h3",{class:"font-semibold"},"Depenses"),e("p",{class:"text-sm text-slate-500"},"Fuel, consommables, beacons...")],-1)),V.value.length>0?(a(),l("div",Ys,[(a(!0),l(H,null,K(V.value,o=>(a(),l("div",{key:o.id,class:"px-5 py-3 flex items-center justify-between group"},[e("div",Qs,[e("span",{class:M(["text-xs px-2 py-1 rounded",Xe(o.type)])},r(Ue(o.type)),3),e("div",null,[e("p",Ws,r(o.description),1),e("p",Zs,r(i(N)(o.date)),1)])]),e("div",Gs,[e("span",Xs,"-"+r(i(T)(o.amount)),1),e("button",{onClick:D=>lt(o.id),class:"opacity-0 group-hover:opacity-100 p-1 hover:bg-red-500/20 rounded text-slate-400 hover:text-red-400 transition-all",title:"Supprimer"},[...t[48]||(t[48]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,eo)])]))),128))])):(a(),l("div",to," Aucune depense enregistree "))])]),e("div",so,[i(x).dailyStats.length>0?(a(),fe(ss,{key:0,data:i(x).dailyStats},null,8,["data"])):v("",!0),i(x).dailyStats.length>0?(a(),fe(ls,{key:1,data:i(x).dailyStats},null,8,["data"])):v("",!0),i(x).stats&&i(x).stats.totals.expenses>0?(a(),fe(ds,{key:2,data:{fuel:((P=i(x).stats.expensesByType)==null?void 0:P.fuel)??0,ammo:((Fe=i(x).stats.expensesByType)==null?void 0:Fe.ammo)??0,crab_beacon:((c=i(x).stats.expensesByType)==null?void 0:c.crab_beacon)??0,other:((Z=i(x).stats.expensesByType)==null?void 0:Z.other)??0}},null,8,["data"])):v("",!0)])],64)):v("",!0),(a(),fe(Le,{to:"body"},[me.value?(a(),l("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:t[8]||(t[8]=Ce(o=>me.value=!1,["self"]))},[e("div",oo,[t[55]||(t[55]=e("h3",{class:"text-lg font-semibold mb-4"},"Ajouter une depense",-1)),e("div",ao,[e("div",null,[t[50]||(t[50]=e("label",{class:"block text-sm text-slate-400 mb-1"},"Type",-1)),xe(e("select",{"onUpdate:modelValue":t[3]||(t[3]=o=>O.value.type=o),class:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-sm focus:outline-none focus:border-cyan-500"},[(a(),l(H,null,K(He,o=>e("option",{key:o.value,value:o.value},r(o.label),9,lo)),64))],512),[[ht,O.value.type]])]),e("div",null,[t[51]||(t[51]=e("label",{class:"block text-sm text-slate-400 mb-1"},[pe("Description "),e("span",{class:"text-red-400"},"*")],-1)),xe(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>O.value.description=o),type:"text",placeholder:"Ex: 500 Helium Isotopes",class:M(["w-full bg-slate-800 border rounded-lg px-4 py-2 text-sm focus:outline-none",Y.value.description?"border-red-500 focus:border-red-500":"border-slate-700 focus:border-cyan-500"])},null,2),[[he,O.value.description]]),Y.value.description?(a(),l("p",no,r(Y.value.description),1)):v("",!0)]),e("div",null,[t[52]||(t[52]=e("label",{class:"block text-sm text-slate-400 mb-1"},[pe("Montant (ISK) "),e("span",{class:"text-red-400"},"*")],-1)),xe(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>O.value.amount=o),type:"number",placeholder:"150000000",class:M(["w-full bg-slate-800 border rounded-lg px-4 py-2 text-sm focus:outline-none",Y.value.amount?"border-red-500 focus:border-red-500":"border-slate-700 focus:border-cyan-500"])},null,2),[[he,O.value.amount]]),Y.value.amount?(a(),l("p",ro,r(Y.value.amount),1)):v("",!0)]),e("div",null,[t[53]||(t[53]=e("label",{class:"block text-sm text-slate-400 mb-1"},"Date",-1)),xe(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>O.value.date=o),type:"date",class:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-sm focus:outline-none focus:border-cyan-500"},null,512),[[he,O.value.date]])])]),e("div",io,[e("button",{onClick:t[7]||(t[7]=o=>me.value=!1),disabled:ge.value,class:"flex-1 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg disabled:opacity-50"}," Annuler ",8,co),e("button",{type:"button",onClick:J,disabled:ge.value,class:"flex-1 py-2 bg-cyan-600 hover:bg-cyan-500 text-white font-medium rounded-lg disabled:opacity-50 flex items-center justify-center gap-2"},[ge.value?(a(),l("svg",po,[...t[54]||(t[54]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):v("",!0),pe(" "+r(ge.value?"Ajout...":"Ajouter"),1)],8,uo)])])])):v("",!0)])),(a(),fe(Le,{to:"body"},[ie.value?(a(),l("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:t[13]||(t[13]=Ce(o=>ie.value=!1,["self"]))},[e("div",vo,[e("div",mo,[t[57]||(t[57]=e("h3",{class:"text-lg font-semibold"},"Consommables PVE",-1)),e("button",{onClick:t[9]||(t[9]=o=>ie.value=!1),class:"text-slate-400 hover:text-slate-300"},[...t[56]||(t[56]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t[61]||(t[61]=e("p",{class:"text-sm text-slate-400 mb-4"}," Ajoutez les consommables que vous utilisez pour le PVE : drogues, munitions, fuel (isotopes), etc. Ils seront detectes lors du scan des contrats et transactions. ",-1)),e("div",xo,[xe(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>ye.value=o),onInput:ze,type:"text",placeholder:"Rechercher un consommable (drogue, munition, isotope...)",class:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-sm focus:outline-none focus:border-cyan-500 pr-10"},null,544),[[he,ye.value]]),f.value?(a(),l("div",fo,[...t[58]||(t[58]=[e("svg",{class:"w-5 h-5 animate-spin text-cyan-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])])):v("",!0)]),w.value.length>0?(a(),l("div",go,[(a(!0),l(H,null,K(w.value,o=>(a(),l("button",{key:o.typeId,onClick:D=>nt(o.typeId),disabled:Q.value,class:"w-full px-4 py-2 text-left hover:bg-slate-700 text-sm flex items-center justify-between group disabled:opacity-50"},[e("span",null,r(o.typeName),1),t[59]||(t[59]=e("svg",{class:"w-4 h-4 text-cyan-500 opacity-0 group-hover:opacity-100",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1))],8,yo))),128))])):v("",!0),t[62]||(t[62]=e("div",{class:"mb-2 text-sm text-slate-400"},"Items configures :",-1)),je.value.length>0?(a(),l("div",bo,[(a(!0),l(H,null,K(je.value,o=>(a(),l("div",{key:o.typeId,class:"flex items-center justify-between bg-slate-800 rounded-lg px-4 py-2"},[e("div",ho,[e("img",{src:i($)(o.typeId,32),alt:o.typeName,class:"w-6 h-6 rounded",onError:t[11]||(t[11]=(...D)=>i(z)&&i(z)(...D))},null,40,ko),e("span",wo,r(o.typeName),1)]),e("button",{onClick:D=>I(o.typeId),class:"p-1 hover:bg-red-500/20 rounded text-slate-400 hover:text-red-400 transition-colors"},[...t[60]||(t[60]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,_o)]))),128))])):(a(),l("div",$o," Aucun item configure ")),e("div",So,[e("button",{onClick:t[12]||(t[12]=o=>ie.value=!1),class:"w-full py-2 bg-slate-800 hover:bg-slate-700 rounded-lg text-white font-medium"}," Fermer ")])])])):v("",!0)])),(a(),fe(Le,{to:"body"},[R.value?(a(),l("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:t[18]||(t[18]=Ce(o=>R.value=!1,["self"]))},[e("div",Co,[e("div",jo,[t[64]||(t[64]=e("h3",{class:"text-lg font-semibold"},"Types de loot",-1)),e("button",{onClick:t[14]||(t[14]=o=>R.value=!1),class:"text-slate-400 hover:text-slate-300"},[...t[63]||(t[63]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t[68]||(t[68]=e("p",{class:"text-sm text-slate-400 mb-4"}," Ajoutez les types de loot que vous vendez (OPE, blue loot, etc.). Seuls ces items seront detectes lors du scan des ventes. ",-1)),e("div",Eo,[xe(e("input",{"onUpdate:modelValue":t[15]||(t[15]=o=>G.value=o),onInput:Je,type:"text",placeholder:"Rechercher un item (ex: Rogue Drone Infestation Data)",class:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-sm focus:outline-none focus:border-amber-500 pr-10"},null,544),[[he,G.value]]),ee.value?(a(),l("div",Io,[...t[65]||(t[65]=[e("svg",{class:"w-5 h-5 animate-spin text-amber-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])])):v("",!0)]),X.value.length>0?(a(),l("div",To,[(a(!0),l(H,null,K(X.value,o=>(a(),l("button",{key:o.typeId,onClick:D=>et(o.typeId),disabled:Re.value,class:"w-full px-4 py-2 text-left hover:bg-slate-700 text-sm flex items-center justify-between group disabled:opacity-50"},[e("span",null,r(o.typeName),1),t[66]||(t[66]=e("svg",{class:"w-4 h-4 text-amber-500 opacity-0 group-hover:opacity-100",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1))],8,Po))),128))])):v("",!0),t[69]||(t[69]=e("div",{class:"mb-2 text-sm text-slate-400"},"Items configures :",-1)),de.value.length>0?(a(),l("div",Mo,[(a(!0),l(H,null,K(de.value,o=>(a(),l("div",{key:o.typeId,class:"flex items-center justify-between bg-slate-800 rounded-lg px-4 py-2"},[e("div",Ao,[e("img",{src:i($)(o.typeId,32),alt:o.typeName,class:"w-6 h-6 rounded",onError:t[16]||(t[16]=(...D)=>i(z)&&i(z)(...D))},null,40,Bo),e("span",Do,r(o.typeName),1)]),e("button",{onClick:D=>Pe(o.typeId),class:"p-1 hover:bg-red-500/20 rounded text-slate-400 hover:text-red-400 transition-colors"},[...t[67]||(t[67]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Fo)]))),128))])):(a(),l("div",No," Aucun type de loot configure ")),e("div",Lo,[e("button",{onClick:t[17]||(t[17]=o=>R.value=!1),class:"w-full py-2 bg-slate-800 hover:bg-slate-700 rounded-lg text-white font-medium"}," Fermer ")])])])):v("",!0)])),(a(),fe(Le,{to:"body"},[Ee.value&&S.value?(a(),l("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:t[22]||(t[22]=Ce(o=>Ee.value=!1,["self"]))},[e("div",zo,[e("div",Vo,[e("div",Oo,[e("div",null,[t[70]||(t[70]=e("h3",{class:"text-lg font-semibold"},"Resultats du scan",-1)),e("p",Ro,r(S.value.scannedContracts)+" contrats, "+r(S.value.scannedTransactions)+" transactions marche - "+r(S.value.detectedExpenses.length)+" depenses detectees ",1)]),e("button",{onClick:t[19]||(t[19]=o=>Ee.value=!1),class:"text-slate-400 hover:text-slate-300"},[...t[71]||(t[71]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),S.value.detectedExpenses.length>0?(a(),l("div",Ho,[e("div",{class:"flex items-center gap-3 mb-4"},[e("button",{onClick:it,class:"text-sm text-cyan-400 hover:text-cyan-300"},"Tout selectionner"),t[72]||(t[72]=e("span",{class:"text-slate-600"},"|",-1)),e("button",{onClick:tt,class:"text-sm text-slate-400 hover:text-slate-300"},"Tout deselectionner")]),e("div",Uo,[(a(!0),l(H,null,K(S.value.detectedExpenses,o=>(a(),l("div",{key:`${o.contractId}-${o.typeId}`,onClick:D=>Me(o),class:M(["p-4 rounded-lg border cursor-pointer transition-colors",o.selected?"bg-slate-800 border-cyan-500/50":"bg-slate-800/50 border-slate-700 opacity-60"])},[e("div",Jo,[e("div",Ko,[e("div",{class:M(["w-5 h-5 rounded border-2 flex items-center justify-center",o.selected?"border-cyan-500 bg-cyan-500":"border-slate-600"])},[o.selected?(a(),l("svg",Yo,[...t[73]||(t[73]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"},null,-1)])])):v("",!0)],2)]),e("img",{src:i($)(o.typeId,64),alt:o.typeName,class:"w-12 h-12 rounded",onError:t[20]||(t[20]=(...D)=>i(z)&&i(z)(...D))},null,40,Qo),e("div",Wo,[e("div",Zo,[e("span",{class:M(["text-xs px-2 py-0.5 rounded",Xe(o.type)])},r(Ue(o.type)),3),o.source==="contract"?(a(),l("span",Go," Contrat #"+r(o.contractId),1)):(a(),l("span",Xo," Marche "))]),e("p",ea,r(o.typeName),1)]),e("div",ta,[e("p",sa,r(i(T)(o.price)),1),e("p",oa,r(i(N)(o.dateIssued)),1)])])],10,qo))),128))])])):(a(),l("div",aa,[...t[74]||(t[74]=[e("div",{class:"text-center text-slate-500"},[e("svg",{class:"w-12 h-12 mx-auto mb-3 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M12 12h.01M12 12h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("p",null,"Aucune depense detectee dans vos contrats"),e("p",{class:"text-sm mt-1"},"Verifiez la configuration des consommables ou la periode")],-1)])])),S.value.detectedExpenses.length>0?(a(),l("div",la,[e("div",na,[e("span",ra,r(S.value.detectedExpenses.filter(o=>o.selected).length)+" depense(s) selectionnee(s) ",1),e("span",ia," Total: "+r(i(T)(S.value.detectedExpenses.filter(o=>o.selected).reduce((o,D)=>o+D.price,0))),1)]),e("div",da,[e("button",{onClick:t[21]||(t[21]=o=>Ee.value=!1),class:"flex-1 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg"}," Annuler "),e("button",{onClick:Ye,disabled:ke.value||S.value.detectedExpenses.filter(o=>o.selected).length===0,class:"flex-1 py-2 bg-cyan-600 hover:bg-cyan-500 text-white font-medium rounded-lg disabled:opacity-50 flex items-center justify-center gap-2"},[ke.value?(a(),l("svg",ua,[...t[75]||(t[75]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):v("",!0),pe(" "+r(ke.value?"Import...":"Importer"),1)],8,ca)])])):v("",!0)])])):v("",!0)])),(a(),fe(Le,{to:"body"},[L.value?(a(),l("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:t[27]||(t[27]=Ce(o=>L.value=!1,["self"]))},[e("div",pa,[t[80]||(t[80]=e("h3",{class:"text-lg font-semibold mb-4"},"Ajouter une vente de loot",-1)),e("div",va,[e("div",null,[t[76]||(t[76]=e("label",{class:"block text-sm text-slate-400 mb-1"},[pe("Description "),e("span",{class:"text-red-400"},"*")],-1)),xe(e("input",{"onUpdate:modelValue":t[23]||(t[23]=o=>q.value.description=o),type:"text",placeholder:"Ex: 100x Overseer's Personal Effects",class:M(["w-full bg-slate-800 border rounded-lg px-4 py-2 text-sm focus:outline-none",E.value.description?"border-red-500 focus:border-red-500":"border-slate-700 focus:border-amber-500"])},null,2),[[he,q.value.description]]),E.value.description?(a(),l("p",ma,r(E.value.description),1)):v("",!0)]),e("div",null,[t[77]||(t[77]=e("label",{class:"block text-sm text-slate-400 mb-1"},[pe("Montant (ISK) "),e("span",{class:"text-red-400"},"*")],-1)),xe(e("input",{"onUpdate:modelValue":t[24]||(t[24]=o=>q.value.amount=o),type:"number",placeholder:"500000000",class:M(["w-full bg-slate-800 border rounded-lg px-4 py-2 text-sm focus:outline-none",E.value.amount?"border-red-500 focus:border-red-500":"border-slate-700 focus:border-amber-500"])},null,2),[[he,q.value.amount]]),E.value.amount?(a(),l("p",xa,r(E.value.amount),1)):v("",!0)]),e("div",null,[t[78]||(t[78]=e("label",{class:"block text-sm text-slate-400 mb-1"},"Date",-1)),xe(e("input",{"onUpdate:modelValue":t[25]||(t[25]=o=>q.value.date=o),type:"date",class:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-sm focus:outline-none focus:border-amber-500"},null,512),[[he,q.value.date]])])]),e("div",fa,[e("button",{onClick:t[26]||(t[26]=o=>L.value=!1),disabled:W.value,class:"flex-1 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg disabled:opacity-50"}," Annuler ",8,ga),e("button",{type:"button",onClick:st,disabled:W.value,class:"flex-1 py-2 bg-amber-600 hover:bg-amber-500 text-white font-medium rounded-lg disabled:opacity-50 flex items-center justify-center gap-2"},[W.value?(a(),l("svg",ba,[...t[79]||(t[79]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):v("",!0),pe(" "+r(W.value?"Ajout...":"Ajouter"),1)],8,ya)])])])):v("",!0)])),(a(),fe(Le,{to:"body"},[ce.value&&A.value?(a(),l("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:t[31]||(t[31]=Ce(o=>ce.value=!1,["self"]))},[e("div",ha,[e("div",ka,[e("div",wa,[e("div",null,[t[81]||(t[81]=e("h3",{class:"text-lg font-semibold"},"Ventes de loot detectees",-1)),e("p",_a,r(A.value.scannedTransactions)+" transactions, "+r(A.value.scannedContracts||0)+" contrats, "+r(A.value.scannedProjects||0)+" projets corp - "+r(A.value.detectedSales.length)+" ventes detectees ",1)]),e("button",{onClick:t[28]||(t[28]=o=>ce.value=!1),class:"text-slate-400 hover:text-slate-300"},[...t[82]||(t[82]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),A.value.detectedSales.length>0?(a(),l("div",$a,[e("div",Sa,[(a(!0),l(H,null,K(A.value.detectedSales,o=>(a(),l("div",{key:o.source==="contract"?`contract-${o.contractId}`:`tx-${o.transactionId}`,class:"p-4 rounded-lg border bg-slate-800 border-slate-700"},[e("div",Ca,[e("img",{src:i($)(o.typeId,64),alt:o.typeName,class:"w-12 h-12 rounded",onError:t[29]||(t[29]=(...D)=>i(z)&&i(z)(...D))},null,40,ja),e("div",Ea,[e("div",Ia,[o.source==="contract"?(a(),l("span",Ta," Contrat #"+r(o.contractId),1)):o.source==="corp_project"?(a(),l("span",Pa,r(o.projectName||"Projet corp"),1)):(a(),l("span",Ma," Marche ")),e("span",Aa,r(o.characterName),1)]),e("p",Ba,r(o.typeName),1),e("p",Da,r(i(N)(o.dateIssued)),1)]),e("div",Fa,[(o.source==="contract"||o.source==="corp_project")&&o.price===0?(a(),l("div",Na,[xe(e("input",{type:"number","onUpdate:modelValue":D=>o.price=D,class:"w-28 px-2 py-1 text-right bg-slate-700 border border-slate-600 rounded text-amber-400 font-mono text-sm focus:outline-none focus:border-amber-500",min:"0",step:"100000",placeholder:o.source==="corp_project"?"Valeur":"Prix"},null,8,La),[[he,o.price,void 0,{number:!0}]]),t[83]||(t[83]=e("span",{class:"text-xs text-slate-500"},"ISK",-1))])):(a(),l("p",za,"+"+r(i(T)(o.price)),1)),e("div",Va,[e("button",{onClick:D=>d(o),disabled:Be.value||(o.source==="contract"||o.source==="corp_project")&&o.price<=0,class:"px-3 py-1 text-xs bg-emerald-600 hover:bg-emerald-500 disabled:bg-slate-600 disabled:cursor-not-allowed rounded text-white font-medium"}," Ajouter ",8,Oa),e("button",{onClick:D=>s(o),disabled:Be.value,class:"px-3 py-1 text-xs bg-slate-600 hover:bg-slate-500 disabled:opacity-50 rounded text-slate-300 font-medium"}," Ignorer ",8,Ra)])])])]))),128))])])):(a(),l("div",Ha,[...t[84]||(t[84]=[e("div",{class:"text-center text-slate-500"},[e("svg",{class:"w-12 h-12 mx-auto mb-3 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})]),e("p",null,"Aucune vente de loot detectee"),e("p",{class:"text-sm mt-1"},"Vendez du loot sur le marche pour le voir apparaitre ici")],-1)])])),A.value.detectedSales.length>0?(a(),l("div",Ua,[e("div",qa,[e("span",Ja,r(A.value.detectedSales.length)+" contrat(s) en attente ",1),e("button",{onClick:t[30]||(t[30]=o=>ce.value=!1),class:"px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-sm"}," Fermer ")])])):v("",!0)])])):v("",!0)]))])}}}),Ya={class:"space-y-6"},Qa={class:"flex items-center justify-between"},Wa={class:"flex items-center gap-4"},Za={class:"flex items-center gap-2 bg-slate-900 rounded-lg p-1"},Ga=["onClick"],Xa={class:"border-b border-slate-800"},el={class:"flex gap-6"},tl=["onClick"],sl={key:0,class:"flex justify-center py-12"},ol={key:1,class:"space-y-6"},al={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ll={class:"bg-slate-900 rounded-xl p-6 border border-slate-800"},nl={class:"flex items-center justify-between"},rl={class:"text-xs text-slate-500"},il={class:"mt-2 text-2xl font-bold text-white"},dl={class:"mt-2 flex items-center gap-2"},cl={class:"flex-1 h-2 bg-slate-700 rounded-full overflow-hidden"},ul={class:"mt-1 flex justify-between text-xs text-slate-500"},pl={class:"bg-slate-900 rounded-xl p-6 border border-cyan-500/20"},vl={class:"mt-2 text-2xl font-bold text-cyan-400"},ml={class:"mt-2 text-xs text-slate-500"},xl={class:"bg-slate-900 rounded-xl p-6 border border-amber-500/20"},fl={class:"mt-2 text-2xl font-bold text-amber-400"},gl={class:"mt-2 text-xs text-slate-500"},yl={class:"bg-slate-900 rounded-xl p-6 border border-slate-800"},bl={key:0,class:"h-64 flex items-end gap-1"},hl=["title"],kl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},wl={class:"bg-slate-900 rounded-xl p-6 border border-slate-800"},_l={class:"space-y-3"},$l={class:"flex items-center justify-between"},Sl={class:"text-white font-medium"},Cl={class:"flex items-center justify-between"},jl={class:"text-white font-medium"},El={class:"flex items-center justify-between"},Il={class:"text-white font-medium"},Tl={class:"flex items-center justify-between"},Pl={class:"text-white font-medium"},Ml={key:0,class:"flex items-center justify-between"},Al={class:"text-white font-medium"},Bl={class:"bg-slate-900 rounded-xl p-6 border border-slate-800"},Dl={class:"space-y-3"},Fl={class:"flex items-center justify-between"},Nl={class:"text-emerald-400 font-medium"},Ll={key:0,class:"flex items-center justify-between"},zl={class:"text-amber-400 font-medium"},Vl={class:"flex items-center justify-between"},Ol={class:"text-slate-500 font-medium"},Rl={class:"text-center text-xs text-slate-500"},Hl={key:0},Ul={key:1},ql={key:2},Jl={key:2},Kl={key:3,class:"space-y-6"},Yl={class:"flex items-center justify-between"},Ql={key:0,class:"text-xs text-slate-500 mt-1"},Wl={key:1,class:"text-xs text-amber-500 mt-1"},Zl={class:"flex items-center gap-3"},Gl={class:"flex items-center gap-1"},Xl=["value"],en={class:"flex items-center gap-1"},tn=["value"],sn={class:"flex items-center gap-2"},on={class:"relative"},an=["placeholder"],ln={class:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center"},nn={key:0,class:"w-4 h-4 animate-spin text-cyan-400",fill:"none",viewBox:"0 0 24 24"},rn={key:0,class:"absolute z-50 top-full left-0 right-0 mt-1 bg-slate-800 border border-slate-600 rounded-lg shadow-xl max-h-60 overflow-y-auto"},dn=["onMousedown"],cn=["disabled"],un=["disabled"],pn={class:"grid grid-cols-3 gap-3"},vn={class:"bg-slate-900 rounded-xl p-4 border border-slate-800"},mn={class:"mt-1 text-xl font-bold text-amber-400"},xn={class:"bg-slate-900 rounded-xl p-4 border border-emerald-500/20"},fn={class:"mt-1 text-xl font-bold text-emerald-400"},gn={class:"text-xs text-slate-500"},yn={class:"bg-slate-900 rounded-xl p-4 border border-amber-500/20"},bn={class:"mt-1 text-xl font-bold text-amber-400"},hn={class:"text-xs text-slate-500"},kn={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},wn={class:"bg-slate-900 rounded-xl p-4 border border-slate-800"},_n={class:"mt-1 text-xl font-bold text-cyan-400"},$n={class:"text-xs text-slate-500"},Sn={class:"bg-slate-900 rounded-xl p-4 border border-slate-800"},Cn={class:"mt-1 text-xl font-bold text-white"},jn={class:"bg-slate-900 rounded-xl p-4 border border-slate-800"},En={class:"mt-1 text-xl font-bold text-white truncate"},In={class:"text-xs text-slate-500"},Tn={class:"bg-slate-900 rounded-xl p-4 border border-slate-800"},Pn={class:"mt-1 text-xl font-bold text-slate-400"},Mn={key:0,class:"text-xs text-amber-400"},An={key:1,class:"text-xs text-emerald-400"},Bn={class:"bg-slate-900 rounded-xl p-4 border border-slate-800"},Dn={class:"flex items-center justify-between mb-2"},Fn={class:"text-xs text-slate-500"},Nn={class:"h-3 flex rounded-full overflow-hidden bg-slate-700"},Ln=["title"],zn=["title"],Vn=["title"],On={key:0,class:"bg-slate-800 border border-cyan-500/30 rounded-xl p-4 flex items-center justify-between sticky top-0 z-10"},Rn={class:"flex items-center gap-4"},Hn={class:"text-cyan-400 font-medium"},Un={class:"flex items-center gap-2"},qn={class:"bg-slate-900 rounded-xl border border-slate-800 overflow-hidden relative"},Jn={class:"px-6 py-4 border-b border-slate-800"},Kn={class:"flex items-center justify-between mb-2"},Yn={class:"flex items-center gap-3"},Qn={class:"text-xs text-slate-500"},Wn={class:"overflow-x-auto"},Zn={class:"w-full"},Gn={class:"bg-slate-900/50"},Xn={class:"px-4 py-3 w-10"},er=["checked","indeterminate"],tr=["title"],sr={key:0,class:"px-3 py-3 text-right text-xs font-medium text-slate-400 uppercase tracking-wider",title:"Prix structure selectionnee"},or={class:"divide-y divide-slate-800"},ar=["onClick"],lr=["checked","onChange"],nr={class:"px-3 py-3 text-sm text-slate-300"},rr={class:"px-3 py-3"},ir={class:"flex items-center gap-2"},dr=["src","alt"],cr=["title"],ur={class:"px-3 py-3 text-sm text-right text-slate-300"},pr={class:"px-3 py-3 text-sm text-right"},vr=["title"],mr={key:1,class:"text-slate-600"},xr={class:"px-3 py-3 text-sm text-right"},fr=["title"],gr={key:1,class:"text-slate-600"},yr={key:0,class:"px-3 py-3 text-sm text-right"},br=["title"],hr={key:1,class:"text-slate-400"},kr={key:2,class:"text-slate-600"},wr={class:"px-3 py-3 text-sm text-right"},_r=["title"],$r={key:1,class:"text-slate-600"},Sr={class:"px-3 py-3 text-sm"},Cr={key:0,class:"p-8 text-center text-slate-500"},jr={key:1,class:"px-6 py-4 border-t border-slate-800 flex items-center justify-between"},Er={class:"text-sm text-slate-400"},Ir={class:"flex items-center gap-1"},Tr=["disabled"],Pr=["disabled"],Mr=["onClick"],Ar={key:1,class:"px-1 text-slate-500"},Br=["disabled"],Dr=["disabled"],Fr={class:"p-1"},Nr={key:4,class:"space-y-6"},Lr={class:"bg-slate-900 rounded-xl p-6 border border-slate-800"},zr={class:"space-y-3"},Vr=["checked"],Or=["checked"],Rr={key:5,class:"bg-red-500/10 border border-red-500/30 rounded-lg p-4"},Hr={class:"text-red-400"},We=20,Qr=Oe({__name:"Ledger",setup(U){const y=Mt(),h=vt(),_=xt(),{formatIskShort:p,formatIskFull:m,formatNumber:x,formatDate:T,formatDateTime:N}=dt(),{getTypeIconUrl:k,onImageError:$}=ft(),z=localStorage.getItem("miningSelectedStructure"),se=z?JSON.parse(z):{id:null,name:""},V=u(se),le=u(""),ne=u([]),re=u(!1),j=u(!1);let me=null;Se(le,d=>{if(me&&clearTimeout(me),!d||d.length<2){ne.value=[];return}me=setTimeout(()=>{O(d)},300)});async function O(d){re.value=!0;try{const s=await fetch(`/api/shopping-list/search-structures?q=${encodeURIComponent(d)}`,{headers:{Authorization:`Bearer ${_.token}`,Accept:"application/json"}});if(s.ok){const b=await s.json();ne.value=b.results,j.value=!0}}catch(s){console.error("Failed to search structures:",s)}finally{re.value=!1}}function ge(d){V.value={id:d.id,name:d.name},localStorage.setItem("miningSelectedStructure",JSON.stringify(V.value)),le.value="",ne.value=[],j.value=!1}function Y(){V.value={id:null,name:""},localStorage.removeItem("miningSelectedStructure"),le.value="",ne.value=[]}function je(){setTimeout(()=>{j.value=!1},200)}const ie=u(!1);async function ye(){if(V.value.id){ie.value=!0;try{if(!(await fetch("/api/shopping-list/sync-structure-market",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${_.token}`,Accept:"application/json"},body:JSON.stringify({structureId:V.value.id})})).ok)throw new Error("Sync failed");await Me()}catch(d){console.error("Failed to sync structure market:",d)}finally{ie.value=!1}}}const w=F(()=>V.value.id),f=u(parseFloat(localStorage.getItem("miningReprocessYield")||"78")),Q=u(parseFloat(localStorage.getItem("miningExportTax")||"1200"));function de(d){const s=Math.max(0,Math.min(100,d));f.value=s,localStorage.setItem("miningReprocessYield",s.toString())}function R(d){const s=d.target,b=parseFloat(s.value);isNaN(b)||de(b)}function G(d){const s=d.target;s.value=f.value.toFixed(2)}function X(d){const s=Math.max(0,d);Q.value=s,localStorage.setItem("miningExportTax",s.toString())}function ee(d){const s=d.target,b=parseFloat(s.value);isNaN(b)||X(b)}function Re(d){const s=d.target;s.value=Q.value.toFixed(0)}const Ee=u(null),S=u("dashboard"),te=u(null),ke=u({x:0,y:0}),L=u(new Set),q=F(()=>L.value.size>0),E=u(1),W=F(()=>Math.ceil(oe.value.length/We)),ce=F(()=>{const d=(E.value-1)*We;return oe.value.slice(d,d+We)});function A(d){d>=1&&d<=W.value&&(E.value=d,be())}function Ae(d,s){s==null||s.stopPropagation();const b=new Set(L.value);b.has(d)?b.delete(d):b.add(d),L.value=b}function Be(){const d=ce.value.map(s=>s.id);L.value=new Set(d)}function be(){L.value=new Set,Ie()}function De(d,s){if(s.preventDefault(),s.stopPropagation(),te.value===d.id){be();return}if(q.value&&!L.value.has(d.id)){Ae(d.id,s);return}q.value||(L.value=new Set([d.id]));const b=224,ae=220,n=8;let t=s.clientX,g=s.clientY+n;t+b>window.innerWidth-n&&(t=window.innerWidth-b-n),t<n&&(t=n),g+ae>window.innerHeight-n&&(g=s.clientY-ae-n),g<n&&(g=n),ke.value={x:t,y:g},te.value=d.id}function Ie(){te.value=null}async function Te(d,s){try{await y.updateMiningEntryUsage(d,s),Ie()}catch(b){console.error("Failed to update entry usage:",b)}}async function He(d){try{const s=Array.from(L.value).map(b=>y.updateMiningEntryUsage(b,d));await Promise.all(s),be()}catch(s){console.error("Failed to update entries usage:",s)}}function ue(d){switch(d){case"sold":return"Personnel (vendu)";case"corp_project":return"Ope Corpo";case"industry":return"Projet Industrie";default:return"Non assigne"}}function we(d){switch(d){case"sold":return"text-emerald-400";case"corp_project":return"text-amber-400";case"industry":return"text-blue-400";default:return"text-slate-500"}}function Ge(d){const s=d.target;!s.closest(".entry-menu")&&!s.closest(".entry-row")&&Ie()}at(()=>{document.addEventListener("click",Ge)}),kt(()=>{document.removeEventListener("click",Ge)});const J=u(parseInt(localStorage.getItem("ledgerSelectedDays")||"30")),lt=[{value:7,label:"7 jours"},{value:14,label:"14 jours"},{value:30,label:"30 jours"},{value:60,label:"60 jours"},{value:90,label:"90 jours"}],Ue=F(()=>{const d=new Date,s=new Date(d.getFullYear(),0,1),b=d.getTime()-s.getTime();return Math.ceil(b/(1e3*60*60*24))}),Xe=F(()=>y.isLoading||h.isLoading),_e=F(()=>y.isSyncing),C=F(()=>y.dashboard),ze=F(()=>y.dailyStats),oe=F(()=>y.miningEntries),nt=F(()=>y.miningStats),I=F(()=>{const d={sold:0,corp_project:0,industry:0,unknown:0,total:0};for(const s of oe.value){const ae=qe(s)*s.quantity;d[s.usage]=(d[s.usage]||0)+ae,d.total+=ae}return d});function qe(d){const s=[];return d.compressedEquivalentPrice&&s.push(d.compressedEquivalentPrice),d.reprocessValue&&s.push(d.reprocessValue),d.structureCompressedUnitPrice&&s.push(d.structureCompressedUnitPrice/100),d.structureReprocessValue&&s.push(d.structureReprocessValue),s.length===0&&d.totalValue&&d.quantity>0?d.totalValue/d.quantity:s.length>0?Math.max(...s):0}const Je=F(()=>new Set(oe.value.map(s=>s.date.split("T")[0])).size),rt=F(()=>Je.value===0?0:I.value.total/Je.value),et=F(()=>{const d={};for(const b of oe.value)d[b.solarSystemId]||(d[b.solarSystemId]={name:b.solarSystemName,value:0}),d[b.solarSystemId].value+=b.totalValue||0;let s={name:"-",value:0,percent:0};for(const b of Object.values(d))b.value>s.value&&(s={...b,percent:0});return I.value.total>0&&(s.percent=s.value/I.value.total*100),s}),Pe=F(()=>y.settings);async function Ke(){await Promise.all([y.fetchDashboard(J.value),y.fetchDailyStats(J.value),y.fetchSettings()])}async function Me(){await Promise.all([y.fetchMiningEntries(J.value,void 0,void 0,w.value,f.value,Q.value),y.fetchMiningStats(J.value)])}async function it(){try{await y.syncMining()}catch(d){console.error("Sync failed:",d)}}async function tt(d){try{await y.updateSettings({corpProjectAccounting:d})}catch(s){console.error("Failed to update settings:",s)}}Se(J,async()=>{localStorage.setItem("ledgerSelectedDays",J.value.toString()),y.setSelectedDays(J.value),h.setSelectedDays(J.value),await Ke(),S.value==="mining"&&await Me()}),Se(S,async d=>{d==="mining"&&oe.value.length===0&&await Me()}),Se(oe,()=>{E.value=1}),Se(V,async()=>{S.value==="mining"&&await Me()},{deep:!0});let Ye=null;Se(f,async()=>{Ye&&clearTimeout(Ye),Ye=setTimeout(async()=>{S.value==="mining"&&await Me()},500)});let Qe=null;Se(Q,async()=>{Qe&&clearTimeout(Qe),Qe=setTimeout(async()=>{S.value==="mining"&&await Me()},500)}),at(async()=>{await Ke()});function st(d){return`${d.toFixed(1)}%`}function Ve(d){const s=[];return d.compressedEquivalentPrice&&s.push({value:d.compressedEquivalentPrice,color:"text-cyan-400",source:"Jita compresse"}),d.reprocessValue&&s.push({value:d.reprocessValue,color:"text-purple-400",source:`Jita reprocess ${f.value.toFixed(0)}%`}),d.structureCompressedUnitPrice&&s.push({value:d.structureCompressedUnitPrice/100,color:"text-teal-400",source:"Structure compresse"}),d.structureReprocessValue&&s.push({value:d.structureReprocessValue,color:"text-lime-400",source:`Structure reprocess ${f.value.toFixed(0)}%`}),s.length===0?{value:0,color:"text-slate-600",source:""}:s.reduce((b,ae)=>ae.value>b.value?ae:b)}const ot=F(()=>{var d;return(d=ze.value)!=null&&d.daily?Math.max(...ze.value.daily.map(s=>s.total)):0});return(d,s)=>(a(),fe(_t,null,{default:wt(()=>{var b,ae,n,t,g,P,Fe;return[e("div",Ya,[e("div",Qa,[e("div",Wa,[e("div",Za,[(a(),l(H,null,K(lt,c=>e("button",{key:c.value,onClick:Z=>J.value=c.value,class:M(["px-3 py-1.5 rounded-md text-sm font-medium transition-colors",J.value===c.value?"bg-cyan-600 text-white":"text-slate-400 hover:text-white hover:bg-slate-700/50"])},r(c.label),11,Ga)),64)),e("button",{onClick:s[0]||(s[0]=c=>J.value=Ue.value),class:M(["px-3 py-1.5 rounded-md text-sm font-medium transition-colors",J.value===Ue.value?"bg-cyan-600 text-white":"text-slate-400 hover:text-white hover:bg-slate-700/50"])}," YTD ",2)])])]),e("div",Xa,[e("nav",el,[(a(),l(H,null,K([{id:"dashboard",label:"Dashboard"},{id:"pve",label:"PVE"},{id:"mining",label:"Mining"},{id:"settings",label:"Parametres"}],c=>e("button",{key:c.id,onClick:Z=>S.value=c.id,class:M(["pb-3 text-sm font-medium border-b-2 transition-colors",S.value===c.id?"border-cyan-500 text-cyan-400":"border-transparent text-slate-400 hover:text-slate-200"])},r(c.label),11,tl)),64))])]),Xe.value&&!C.value?(a(),l("div",sl,[...s[18]||(s[18]=[e("svg",{class:"animate-spin h-8 w-8 text-cyan-500",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):S.value==="dashboard"&&C.value?(a(),l("div",ol,[e("div",al,[e("div",ll,[e("div",nl,[s[19]||(s[19]=e("span",{class:"text-slate-400 text-sm"},"Total",-1)),e("span",rl,r(J.value)+"j",1)]),e("div",il,r(i(p)(C.value.totals.total)),1),e("div",dl,[e("div",cl,[e("div",{class:"h-full bg-gradient-to-r from-cyan-500 to-blue-500",style:Ne({width:`${C.value.pvePercent}%`})},null,4)])]),e("div",ul,[e("span",null,"PVE "+r(st(C.value.pvePercent)),1),e("span",null,"Mining "+r(st(C.value.miningPercent)),1)])]),e("div",pl,[s[20]||(s[20]=e("div",{class:"flex items-center justify-between"},[e("span",{class:"text-cyan-400 text-sm"},"PVE"),e("svg",{class:"w-5 h-5 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})])],-1)),e("div",vl,r(i(p)(C.value.totals.pve)),1),e("div",ml," Bounties: "+r(i(p)(C.value.pveBreakdown.bounties)),1)]),e("div",xl,[s[21]||(s[21]=e("div",{class:"flex items-center justify-between"},[e("span",{class:"text-amber-400 text-sm"},"Mining"),e("svg",{class:"w-5 h-5 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})])],-1)),e("div",fl,r(i(p)(C.value.totals.mining)),1),e("div",gl," ISK/jour: "+r(i(p)(C.value.iskPerDay)),1)])]),e("div",yl,[s[22]||(s[22]=e("h3",{class:"text-lg font-semibold text-white mb-4"},"Revenus journaliers",-1)),(b=ze.value)!=null&&b.daily?(a(),l("div",bl,[(a(!0),l(H,null,K(ze.value.daily,c=>(a(),l("div",{key:c.date,class:"flex-1 flex flex-col justify-end gap-px",title:`${i(T)(c.date)}
PVE: ${i(m)(c.pve)}
Mining: ${i(m)(c.mining)}`},[c.mining>0?(a(),l("div",{key:0,class:"bg-amber-500/80 rounded-t-sm min-h-[2px]",style:Ne({height:`${c.mining/ot.value*200}px`})},null,4)):v("",!0),c.pve>0?(a(),l("div",{key:1,class:M(["bg-cyan-500/80 min-h-[2px]",{"rounded-t-sm":c.mining===0}]),style:Ne({height:`${c.pve/ot.value*200}px`})},null,6)):v("",!0)],8,hl))),128))])):v("",!0),s[23]||(s[23]=e("div",{class:"mt-4 flex items-center justify-center gap-6 text-sm"},[e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-3 h-3 bg-cyan-500 rounded"}),e("span",{class:"text-slate-400"},"PVE")]),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-3 h-3 bg-amber-500 rounded"}),e("span",{class:"text-slate-400"},"Mining")])],-1))]),e("div",kl,[e("div",wl,[s[29]||(s[29]=e("h3",{class:"text-lg font-semibold text-white mb-4"},"Repartition PVE",-1)),e("div",_l,[e("div",$l,[s[24]||(s[24]=e("span",{class:"text-slate-400"},"Bounties",-1)),e("span",Sl,r(i(p)(C.value.pveBreakdown.bounties)),1)]),e("div",Cl,[s[25]||(s[25]=e("span",{class:"text-slate-400"},"ESS",-1)),e("span",jl,r(i(p)(C.value.pveBreakdown.ess)),1)]),e("div",El,[s[26]||(s[26]=e("span",{class:"text-slate-400"},"Missions",-1)),e("span",Il,r(i(p)(C.value.pveBreakdown.missions)),1)]),e("div",Tl,[s[27]||(s[27]=e("span",{class:"text-slate-400"},"Loot",-1)),e("span",Pl,r(i(p)(C.value.pveBreakdown.lootSales)),1)]),C.value.settings.corpProjectAccounting==="pve"?(a(),l("div",Ml,[s[28]||(s[28]=e("span",{class:"text-slate-400"},"Projets corpo",-1)),e("span",Al,r(i(p)(C.value.pveBreakdown.corpProjects)),1)])):v("",!0)])]),e("div",Bl,[s[33]||(s[33]=e("h3",{class:"text-lg font-semibold text-white mb-4"},"Repartition Mining",-1)),e("div",Dl,[e("div",Fl,[s[30]||(s[30]=e("span",{class:"text-slate-400"},"Vendu",-1)),e("span",Nl,r(i(p)(C.value.miningBreakdown.sold)),1)]),C.value.settings.corpProjectAccounting==="mining"?(a(),l("div",Ll,[s[31]||(s[31]=e("span",{class:"text-slate-400"},"Ope corpo",-1)),e("span",zl,r(i(p)(C.value.miningBreakdown.corpProject)),1)])):v("",!0),e("div",Vl,[s[32]||(s[32]=e("span",{class:"text-slate-400"},"Non assigne",-1)),e("span",Ol,r(i(p)(C.value.miningBreakdown.unknown)),1)])])])]),e("div",Rl,[C.value.lastSync.pve?(a(),l("span",Hl,"PVE: "+r(i(N)(C.value.lastSync.pve)),1)):v("",!0),C.value.lastSync.pve&&C.value.lastSync.mining?(a(),l("span",Ul," | ")):v("",!0),C.value.lastSync.mining?(a(),l("span",ql,"Mining: "+r(i(N)(C.value.lastSync.mining)),1)):v("",!0)])])):S.value==="pve"?(a(),l("div",Jl,[Ze(Ka,{ref_key:"pveTabRef",ref:Ee,"selected-days":J.value,onSync:Ke},null,8,["selected-days"])])):S.value==="mining"?(a(),l("div",Kl,[e("div",Yl,[e("div",null,[s[34]||(s[34]=e("p",{class:"text-slate-400"},"Suivi du minage",-1)),(ae=Pe.value)!=null&&ae.lastMiningSyncAt?(a(),l("p",Ql," Derniere sync : "+r(i(N)(Pe.value.lastMiningSyncAt)),1)):(a(),l("p",Wl," Aucune synchronisation effectuee "))]),e("div",Zl,[e("div",Gl,[s[35]||(s[35]=e("span",{class:"text-xs text-slate-500"},"Export :",-1)),e("input",{type:"number",value:Q.value.toFixed(0),onChange:ee,onBlur:Re,min:"0",step:"100",class:"w-20 bg-slate-800/50 border border-slate-600 rounded-lg px-2 py-2 text-sm text-slate-200 text-right focus:outline-none focus:border-cyan-500/50",title:"Taxe export Jita (ISK/m³)"},null,40,Xl),s[36]||(s[36]=e("span",{class:"text-xs text-slate-500"},"ISK/m³",-1))]),e("div",en,[s[37]||(s[37]=e("span",{class:"text-xs text-slate-500"},"Yield :",-1)),e("input",{type:"number",value:f.value.toFixed(2),onChange:R,onBlur:G,min:"0",max:"100",step:"0.01",class:"w-20 bg-slate-800/50 border border-slate-600 rounded-lg px-2 py-2 text-sm text-slate-200 text-right focus:outline-none focus:border-cyan-500/50"},null,40,tn),s[38]||(s[38]=e("span",{class:"text-xs text-slate-500"},"%",-1))]),e("div",sn,[s[42]||(s[42]=e("span",{class:"text-xs text-slate-500"},"Structure :",-1)),e("div",on,[xe(e("input",{"onUpdate:modelValue":s[1]||(s[1]=c=>le.value=c),type:"text",placeholder:V.value.id?V.value.name:"C-J6MT - 1st Taj Mahgoon (defaut)",onFocus:s[2]||(s[2]=c=>j.value=!0),onBlur:je,class:M(["w-80 rounded-lg pl-3 pr-10 py-2 text-sm focus:outline-none",V.value.id?"bg-slate-800/50 border-2 border-cyan-500/50 text-cyan-400 placeholder-cyan-400":"bg-slate-800/50 border border-slate-600 text-slate-200 placeholder-slate-400 focus:border-cyan-500/50"])},null,42,an),[[he,le.value]]),e("div",ln,[re.value?(a(),l("svg",nn,[...s[39]||(s[39]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):V.value.id||le.value?(a(),l("button",{key:1,onMousedown:Ce(Y,["prevent"]),class:"text-slate-400 hover:text-slate-200",title:"Revenir au defaut"},[...s[40]||(s[40]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],32)):v("",!0)]),j.value&&ne.value.length>0?(a(),l("div",rn,[(a(!0),l(H,null,K(ne.value,c=>(a(),l("button",{key:c.id,onMousedown:Ce(Z=>ge(c),["prevent"]),class:"w-full px-3 py-2 text-left text-sm text-slate-200 hover:bg-slate-700/50 first:rounded-t-lg last:rounded-b-lg"},r(c.name),41,dn))),128))])):v("",!0)]),V.value.id?(a(),l("button",{key:0,onClick:ye,disabled:ie.value,class:"px-2 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-slate-300 text-sm disabled:opacity-50",title:"Synchroniser les prix de la structure"},[(a(),l("svg",{class:M(["w-4 h-4",ie.value?"animate-spin":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...s[41]||(s[41]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2))],8,cn)):v("",!0)]),e("button",{onClick:it,disabled:_e.value,class:"px-4 py-2 bg-amber-600 hover:bg-amber-500 rounded-lg text-white text-sm font-medium flex items-center gap-2 disabled:opacity-50"},[(a(),l("svg",{class:M(["w-4 h-4",_e.value?"animate-spin":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...s[43]||(s[43]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2)),pe(" "+r(_e.value?"Sync...":"Rafraichir"),1)],8,un)])]),e("div",pn,[e("div",vn,[s[44]||(s[44]=e("span",{class:"text-slate-400 text-xs uppercase tracking-wider"},"Valeur totale",-1)),e("div",mn,r(i(p)(I.value.total)),1)]),e("div",xn,[s[45]||(s[45]=e("span",{class:"text-emerald-400 text-xs uppercase tracking-wider"},"Personnel",-1)),e("div",fn,r(i(p)(I.value.sold)),1),e("div",gn,r(I.value.total>0?(I.value.sold/I.value.total*100).toFixed(0):0)+"%",1)]),e("div",yn,[s[46]||(s[46]=e("span",{class:"text-amber-400 text-xs uppercase tracking-wider"},"Corpo",-1)),e("div",bn,r(i(p)(I.value.corp_project)),1),e("div",hn,r(I.value.total>0?(I.value.corp_project/I.value.total*100).toFixed(0):0)+"%",1)])]),e("div",kn,[e("div",wn,[s[47]||(s[47]=e("span",{class:"text-slate-400 text-xs uppercase tracking-wider"},"ISK / jour actif",-1)),e("div",_n,r(i(p)(rt.value)),1),e("div",$n,r(Je.value)+" jours actifs",1)]),e("div",Sn,[s[48]||(s[48]=e("span",{class:"text-slate-400 text-xs uppercase tracking-wider"},"Volume mine",-1)),e("div",Cn,r(i(x)(((n=nt.value)==null?void 0:n.totals.totalQuantity)||0)),1),s[49]||(s[49]=e("div",{class:"text-xs text-slate-500"},"unites",-1))]),e("div",jn,[s[50]||(s[50]=e("span",{class:"text-slate-400 text-xs uppercase tracking-wider"},"Systeme principal",-1)),e("div",En,r(et.value.name),1),e("div",In,r(et.value.percent.toFixed(0))+"% du volume",1)]),e("div",Tn,[s[51]||(s[51]=e("span",{class:"text-slate-400 text-xs uppercase tracking-wider"},"Non assigne",-1)),e("div",Pn,r(i(p)(I.value.unknown)),1),I.value.unknown>0?(a(),l("div",Mn,"A categoriser")):(a(),l("div",An,"Tout assigne"))])]),e("div",Bn,[e("div",Dn,[s[52]||(s[52]=e("span",{class:"text-sm text-slate-400"},"Repartition du minerai",-1)),e("span",Fn,r(i(p)(I.value.total))+" total",1)]),e("div",Nn,[I.value.sold>0?(a(),l("div",{key:0,class:"bg-emerald-500 h-full transition-all",style:Ne({width:`${I.value.sold/I.value.total*100}%`}),title:`Personnel: ${i(p)(I.value.sold)}`},null,12,Ln)):v("",!0),I.value.corp_project>0?(a(),l("div",{key:1,class:"bg-amber-500 h-full transition-all",style:Ne({width:`${I.value.corp_project/I.value.total*100}%`}),title:`Corpo: ${i(p)(I.value.corp_project)}`},null,12,zn)):v("",!0),I.value.unknown>0?(a(),l("div",{key:2,class:"bg-slate-500 h-full transition-all",style:Ne({width:`${I.value.unknown/I.value.total*100}%`}),title:`Non assigne: ${i(p)(I.value.unknown)}`},null,12,Vn)):v("",!0)]),s[53]||(s[53]=e("div",{class:"flex flex-wrap justify-center gap-6 mt-2 text-xs"},[e("div",{class:"flex items-center gap-1"},[e("div",{class:"w-2 h-2 bg-emerald-500 rounded-full"}),e("span",{class:"text-slate-400"},"Personnel")]),e("div",{class:"flex items-center gap-1"},[e("div",{class:"w-2 h-2 bg-amber-500 rounded-full"}),e("span",{class:"text-slate-400"},"Corpo")]),e("div",{class:"flex items-center gap-1"},[e("div",{class:"w-2 h-2 bg-slate-500 rounded-full"}),e("span",{class:"text-slate-400"},"Non assigne")])],-1))]),q.value?(a(),l("div",On,[e("div",Rn,[e("span",Hn,r(L.value.size)+" selectionne(s)",1),e("button",{onClick:Be,class:"text-sm text-slate-400 hover:text-white"}," Tout selectionner "),e("button",{onClick:be,class:"text-sm text-slate-400 hover:text-white"}," Annuler ")]),e("div",Un,[s[54]||(s[54]=e("span",{class:"text-sm text-slate-400 mr-2"},"Definir comme :",-1)),e("button",{onClick:s[3]||(s[3]=c=>He("sold")),class:"px-3 py-1.5 bg-emerald-600 hover:bg-emerald-500 rounded-lg text-white text-sm font-medium"}," Personnel "),e("button",{onClick:s[4]||(s[4]=c=>He("corp_project")),class:"px-3 py-1.5 bg-amber-600 hover:bg-amber-500 rounded-lg text-white text-sm font-medium"}," Corpo ")])])):v("",!0),e("div",qn,[e("div",Jn,[e("div",Kn,[e("div",Yn,[s[55]||(s[55]=e("h3",{class:"text-lg font-semibold text-white"},"Entrees mining",-1)),e("span",Qn,"("+r(oe.value.length)+" entrees, page "+r(E.value)+"/"+r(W.value)+")",1)]),s[56]||(s[56]=e("p",{class:"text-xs text-slate-500"},"Cliquez sur une ligne pour changer son statut",-1))]),s[57]||(s[57]=e("div",{class:"flex flex-wrap items-center gap-x-4 gap-y-1 text-xs"},[e("span",{class:"text-slate-500"},"Meilleur prix :"),e("div",{class:"flex items-center gap-1"},[e("span",{class:"text-cyan-400"},"●"),e("span",{class:"text-slate-500"},"Jita comp.")]),e("div",{class:"flex items-center gap-1"},[e("span",{class:"text-purple-400"},"●"),e("span",{class:"text-slate-500"},"Jita reproc.")]),e("div",{class:"flex items-center gap-1"},[e("span",{class:"text-teal-400"},"●"),e("span",{class:"text-slate-500"},"Struct. comp.")]),e("div",{class:"flex items-center gap-1"},[e("span",{class:"text-lime-400"},"●"),e("span",{class:"text-slate-500"},"Struct. reproc.")])],-1))]),e("div",Wn,[e("table",Zn,[e("thead",Gn,[e("tr",null,[e("th",Xn,[e("input",{type:"checkbox",checked:L.value.size===ce.value.length&&ce.value.length>0,indeterminate:L.value.size>0&&L.value.size<ce.value.length,onChange:s[5]||(s[5]=c=>L.value.size===ce.value.length?be():Be()),class:"w-4 h-4 rounded border-slate-600 bg-slate-700 text-cyan-500 focus:ring-cyan-500 focus:ring-offset-slate-800"},null,40,er)]),s[58]||(s[58]=e("th",{class:"px-3 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"},"Date",-1)),s[59]||(s[59]=e("th",{class:"px-3 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"},"Type",-1)),s[60]||(s[60]=e("th",{class:"px-3 py-3 text-right text-xs font-medium text-slate-400 uppercase tracking-wider"},"Qte",-1)),s[61]||(s[61]=e("th",{class:"px-3 py-3 text-right text-xs font-medium text-slate-400 uppercase tracking-wider",title:"Prix equivalent compresse Jita (divise par 100)"},"Compress",-1)),e("th",{class:"px-3 py-3 text-right text-xs font-medium text-slate-400 uppercase tracking-wider",title:`Valeur reprocess par unite (${f.value.toFixed(2)}% yield)`},"Reproc. "+r(f.value.toFixed(2))+"%",9,tr),w.value?(a(),l("th",sr,"Structure")):v("",!0),s[62]||(s[62]=e("th",{class:"px-3 py-3 text-right text-xs font-medium text-slate-400 uppercase tracking-wider"},"Total",-1)),s[63]||(s[63]=e("th",{class:"px-3 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"},"Statut",-1))])]),e("tbody",or,[(a(!0),l(H,null,K(ce.value,c=>(a(),l("tr",{key:c.id,class:M(["entry-row hover:bg-slate-900/30 cursor-pointer transition-colors",{"bg-slate-900/50":te.value===c.id,"bg-cyan-900/20":L.value.has(c.id)}]),onClick:Z=>De(c,Z)},[e("td",{class:"px-4 py-3 w-10",onClick:s[6]||(s[6]=Ce(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:L.value.has(c.id),onChange:Z=>Ae(c.id,Z),class:"w-4 h-4 rounded border-slate-600 bg-slate-700 text-cyan-500 focus:ring-cyan-500 focus:ring-offset-slate-800"},null,40,lr)]),e("td",nr,r(i(T)(c.date)),1),e("td",rr,[e("div",ir,[e("img",{src:i(k)(c.typeId),alt:c.typeName,class:"w-5 h-5",onError:s[7]||(s[7]=(...Z)=>i($)&&i($)(...Z))},null,40,dr),e("span",{class:"text-sm text-white truncate max-w-[120px]",title:c.typeName},r(c.typeName),9,cr)])]),e("td",ur,r(i(x)(c.quantity,0)),1),e("td",pr,[c.compressedEquivalentPrice?(a(),l("span",{key:0,class:"text-cyan-400",title:`${c.compressedTypeName}: ${i(x)(c.compressedUnitPrice||0,0)} ISK/u`},r(i(x)(c.compressedEquivalentPrice,1)),9,vr)):(a(),l("span",mr,"-"))]),e("td",xr,[c.reprocessValue?(a(),l("span",{key:0,class:"text-purple-400",title:`Valeur reprocess par unite (${f.value.toFixed(2)}% yield)`},r(i(x)(c.reprocessValue,2)),9,fr)):(a(),l("span",gr,"-"))]),w.value?(a(),l("td",yr,[c.structureCompressedUnitPrice?(a(),l("span",{key:0,class:"text-emerald-400",title:`Compresse: ${i(x)(c.structureCompressedUnitPrice,0)} ISK/u`},r(i(x)(c.structureCompressedUnitPrice/100,1)),9,br)):c.structureUnitPrice?(a(),l("span",hr,r(i(x)(c.structureUnitPrice,0)),1)):(a(),l("span",kr,"-"))])):v("",!0),e("td",wr,[Ve(c).value>0?(a(),l("span",{key:0,class:M([Ve(c).color,"font-medium"]),title:Ve(c).source},r(i(p)(Ve(c).value*c.quantity)),11,_r)):(a(),l("span",$r,"-"))]),e("td",Sr,[e("span",{class:M([we(c.usage),"text-xs font-medium"])},r(ue(c.usage)),3)])],10,ar))),128))])])]),oe.value.length===0?(a(),l("div",Cr,' Aucune donnee de minage. Cliquez sur "Rafraichir" pour importer vos donnees. ')):v("",!0),W.value>1?(a(),l("div",jr,[e("div",Er,r((E.value-1)*We+1)+"-"+r(Math.min(E.value*We,oe.value.length))+" sur "+r(oe.value.length),1),e("div",Ir,[e("button",{onClick:s[8]||(s[8]=c=>A(1)),disabled:E.value===1,class:"px-2 py-1 text-sm rounded hover:bg-slate-700/50 disabled:opacity-30 disabled:cursor-not-allowed text-slate-400"}," << ",8,Tr),e("button",{onClick:s[9]||(s[9]=c=>A(E.value-1)),disabled:E.value===1,class:"px-2 py-1 text-sm rounded hover:bg-slate-700/50 disabled:opacity-30 disabled:cursor-not-allowed text-slate-400"}," < ",8,Pr),(a(!0),l(H,null,K(W.value,c=>(a(),l(H,{key:c},[c===1||c===W.value||c>=E.value-1&&c<=E.value+1?(a(),l("button",{key:0,onClick:Z=>A(c),class:M(["px-3 py-1 text-sm rounded transition-colors",c===E.value?"bg-cyan-600 text-white":"text-slate-400 hover:bg-slate-700/50"])},r(c),11,Mr)):c===E.value-2||c===E.value+2?(a(),l("span",Ar,"...")):v("",!0)],64))),128)),e("button",{onClick:s[10]||(s[10]=c=>A(E.value+1)),disabled:E.value===W.value,class:"px-2 py-1 text-sm rounded hover:bg-slate-700/50 disabled:opacity-30 disabled:cursor-not-allowed text-slate-400"}," > ",8,Br),e("button",{onClick:s[11]||(s[11]=c=>A(W.value)),disabled:E.value===W.value,class:"px-2 py-1 text-sm rounded hover:bg-slate-700/50 disabled:opacity-30 disabled:cursor-not-allowed text-slate-400"}," >> ",8,Dr)])])):v("",!0),(a(),fe(Le,{to:"body"},[te.value&&!q.value?(a(),l("div",{key:0,class:"entry-menu fixed z-50 w-56 bg-slate-800 border border-slate-700 rounded-lg shadow-xl overflow-hidden",style:Ne({left:`${ke.value.x}px`,top:`${ke.value.y}px`})},[s[67]||(s[67]=e("div",{class:"p-2 border-b border-slate-800"},[e("p",{class:"text-xs text-slate-500 px-2"},"Changer le statut")],-1)),e("div",Fr,[e("button",{onClick:s[12]||(s[12]=c=>Te(te.value,"sold")),class:"w-full px-3 py-2 text-left text-sm rounded-md hover:bg-slate-700/50 flex items-center gap-3 transition-colors"},[...s[64]||(s[64]=[e("span",{class:"w-2 h-2 bg-emerald-400 rounded-full"},null,-1),e("span",{class:"text-white"},"Personnel (vendu)",-1)])]),e("button",{onClick:s[13]||(s[13]=c=>Te(te.value,"corp_project")),class:"w-full px-3 py-2 text-left text-sm rounded-md hover:bg-slate-700/50 flex items-center gap-3 transition-colors"},[...s[65]||(s[65]=[e("span",{class:"w-2 h-2 bg-amber-400 rounded-full"},null,-1),e("span",{class:"text-white"},"Ope Corpo",-1)])]),e("button",{onClick:s[14]||(s[14]=c=>Te(te.value,"unknown")),class:"w-full px-3 py-2 text-left text-sm rounded-md hover:bg-slate-700/50 flex items-center gap-3 transition-colors"},[...s[66]||(s[66]=[e("span",{class:"w-2 h-2 bg-slate-500 rounded-full"},null,-1),e("span",{class:"text-white"},"Non assigne",-1)])])])],4)):v("",!0)]))])])):S.value==="settings"?(a(),l("div",Nr,[e("div",Lr,[s[70]||(s[70]=e("h3",{class:"text-lg font-semibold text-white mb-4"},"Comptabilisation des projets corporation",-1)),s[71]||(s[71]=e("p",{class:"text-slate-400 text-sm mb-4"}," Choisissez comment comptabiliser les contributions aux projets corporation pour eviter le double comptage. ",-1)),e("div",zr,[e("label",{class:M(["flex items-start gap-3 p-4 rounded-lg border cursor-pointer transition-colors",((t=Pe.value)==null?void 0:t.corpProjectAccounting)==="pve"?"bg-cyan-500/10 border-cyan-500/30":"border-slate-700 hover:border-slate-600"])},[e("input",{type:"radio",name:"corpProjectAccounting",value:"pve",checked:((g=Pe.value)==null?void 0:g.corpProjectAccounting)==="pve",onChange:s[15]||(s[15]=c=>tt("pve")),class:"mt-1"},null,40,Vr),s[68]||(s[68]=e("div",null,[e("div",{class:"text-white font-medium"},"Cote PVE (ISK recus)"),e("div",{class:"text-sm text-slate-400 mt-1"}," Les revenus des projets corporation apparaissent dans le module PVE. Le minerai correspondant est exclu des stats Mining. "),e("div",{class:"text-xs text-cyan-400 mt-2"},"Recommande")],-1))],2),e("label",{class:M(["flex items-start gap-3 p-4 rounded-lg border cursor-pointer transition-colors",((P=Pe.value)==null?void 0:P.corpProjectAccounting)==="mining"?"bg-amber-500/10 border-amber-500/30":"border-slate-700 hover:border-slate-600"])},[e("input",{type:"radio",name:"corpProjectAccounting",value:"mining",checked:((Fe=Pe.value)==null?void 0:Fe.corpProjectAccounting)==="mining",onChange:s[16]||(s[16]=c=>tt("mining")),class:"mt-1"},null,40,Or),s[69]||(s[69]=e("div",null,[e("div",{class:"text-white font-medium"},"Cote Mining (valeur minerai)"),e("div",{class:"text-sm text-slate-400 mt-1"}," Le minerai contribue est valorise dans le module Mining. Les revenus ISK des projets corporation sont exclus du PVE. ")],-1))],2)]),s[72]||(s[72]=e("div",{class:"mt-4 p-3 bg-slate-900/50 rounded-lg"},[e("div",{class:"flex items-center gap-2 text-xs text-slate-500"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",null,"Les minerais issus du reprocessing de salvage ne sont pas dans le Mining Ledger ESI, donc toujours comptes en PVE.")])],-1))])])):v("",!0),i(y).error?(a(),l("div",Rr,[e("p",Hr,r(i(y).error),1),e("button",{onClick:s[17]||(s[17]=c=>i(y).clearError()),class:"mt-2 text-sm text-red-400 hover:text-red-300"}," Fermer ")])):v("",!0)])]}),_:1}))}});export{Qr as default};
